<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="color-scheme" content="light dark" />
    <title>MegaBytesMe - Ben</title>
    <style>
      :root {
        --scroll-duration: 70s;
        --min-card-width: 320px;
        --min-card-height: 400px;

        --card-bg-light: rgba(255, 255, 255, 0.85);
        --card-bg-dark: rgba(40, 40, 40, 0.85);
        --text-color-light: #201f1e;
        --text-color-dark: #f0f0f0;
        --heading-color-light: #1a1a1a;
        --heading-color-dark: #ffffff;
        --subtle-text-light: #333;
        --subtle-text-dark: #cccccc;
        --border-color-light: rgba(0, 0, 0, 0.1);
        --border-color-dark: rgba(255, 255, 255, 0.15);
        --handle-bg-light: rgba(0, 0, 0, 0.05);
        --handle-bg-dark: rgba(255, 255, 255, 0.08);
        --shadow-color-light: rgba(0, 0, 0, 0.15);
        --shadow-color-dark: rgba(0, 0, 0, 0.4);
        --link-color-light: #0078d4;
        --link-color-dark: #2899f5;
        --link-hover-light: #005a9e;
        --link-hover-dark: #56b1f7;
        --button-bg-light: #0078d4;
        --button-bg-dark: #2899f5;
        --button-text-light: white;
        --button-text-dark: black;
        --button-hover-bg-light: #005a9e;
        --button-hover-bg-dark: #56b1f7;
        --button-active-bg-light: #004c87;
        --button-active-bg-dark: #1a8ad8;
        --resize-handle-border-light: rgba(0, 0, 0, 0.1);
        --resize-handle-border-dark: rgba(255, 255, 255, 0.2);
        --resize-handle-fill-light: rgba(0, 0, 0, 0.1);
        --resize-handle-fill-dark: rgba(255, 255, 255, 0.2);
        --section-separator-light: rgba(0, 0, 0, 0.08);
        --section-separator-dark: rgba(255, 255, 255, 0.1);
        --window-button-hover-bg-light: rgba(0, 0, 0, 0.1);
        --window-button-hover-bg-dark: rgba(255, 255, 255, 0.15);
        --window-button-close-hover-bg-light: #e81123;
        --window-button-close-hover-bg-dark: #e81123;
        --window-button-close-hover-text-light: white;
        --window-button-close-hover-text-dark: white;
        --window-button-text-light: var(--text-color-light);
        --window-button-text-dark: var(--text-color-dark);
        --reopen-button-bg-light: rgba(255, 255, 255, 0.7);
        --reopen-button-bg-dark: rgba(50, 50, 50, 0.7);
        --reopen-button-text-light: #000;
        --reopen-button-text-dark: #fff;
        --copyright-bg-light: rgba(0, 0, 0, 0.5);
        --copyright-bg-dark: rgba(0, 0, 0, 0.7);
        --copyright-text-light: #ffffff;
        --copyright-text-dark: #cccccc;

        --bg-image-landscape: url("https://windows10spotlight.com/wp-content/uploads/2025/03/862c9b0ab32209d19a329e88d67af1e9.jpg");
        --bg-image-portrait: url("https://windows10spotlight.com/wp-content/uploads/2025/03/996ac5d452384af9ed57976915617a0d.jpg");
      }

      html {
        color-scheme: light dark;
      }

      body,
      html {
        margin: 0;
        padding: 0;
        height: 100%;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        box-sizing: border-box;
        overflow: hidden;
      }
      *,
      *:before,
      *:after {
        box-sizing: inherit;
      }

      body {
        background: var(--bg-image-landscape) no-repeat center center fixed;
        background-size: cover;
        color: var(--text-color-light);
        background-color: #fff;
      }

      @media (orientation: portrait) {
        body {
          background-image: var(--bg-image-portrait);
        }
      }

      .fluent-card {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 90%;
        max-width: 600px;
        min-width: var(--min-card-width);
        height: 75vh;
        max-height: 95vh;
        min-height: var(--min-card-height);
        padding: 0;
        background: var(--card-bg-light);
        backdrop-filter: blur(15px);
        -webkit-backdrop-filter: blur(15px);
        border-radius: 8px;
        border: 1px solid var(--border-color-light);
        box-shadow: 0 8px 30px var(--shadow-color-light);
        text-align: left;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        cursor: default;
        resize: none;
        z-index: 1;
      }

      @media (screen-spanning: single-fold-vertical) {
        .fluent-card {
          left: 10px !important;
          top: 10px !important;
          width: calc(env(fold-left, 50vw) - 20px) !important;
          height: calc(100vh - 20px) !important;
          max-width: none !important;
          transform: none !important;
          transition: none !important;
        }
      }

      .drag-handle {
        padding: 6px 5px 6px 15px;
        cursor: grab;
        background-color: var(--handle-bg-light);
        border-bottom: 1px solid var(--border-color-light);
        user-select: none;
        -webkit-user-select: none;
        touch-action: none;
        display: flex;
        align-items: center;
        gap: 10px;
        flex-shrink: 0;
        position: relative;
        z-index: 20;
      }
      .drag-handle img.handle-pic {
        width: 20px;
        height: 20px;
        border-radius: 50%;
        object-fit: cover;
        flex-shrink: 0;
        border: 1px solid var(--border-color-light);
      }
      .drag-handle h1.handle-title {
        margin: 0;
        font-size: 15px;
        font-weight: 600;
        line-height: 1.4;
        color: var(--heading-color-light);
        flex-grow: 1;
        pointer-events: none;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        margin-right: 5px;
      }

      .window-controls {
        display: flex;
        align-items: center;
        flex-shrink: 0;
      }

      .window-button {
        -webkit-appearance: none;
        appearance: none;
        background: none;
        border: none;
        padding: 0;
        margin: 0 1px;
        width: 34px;
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 16px;
        line-height: 1;
        color: var(--window-button-text-light);
        cursor: pointer;
        pointer-events: auto;
        transition: background-color 0.1s ease;
        font-family: "Segoe UI Symbol", sans-serif;
        border-radius: 2px;
      }
      .window-button:disabled {
        opacity: 0.5;
        cursor: default;
        pointer-events: none;
      }

      .window-button:not(:disabled):hover {
        background-color: var(--window-button-hover-bg-light);
      }
      .window-button.close:not(:disabled):hover {
        background-color: var(--window-button-close-hover-bg-light);
        color: var(--window-button-close-hover-text-light);
      }

      .fluent-card-content {
        padding: 0;
        overflow-y: auto;
        flex-grow: 1;
        position: relative;
        z-index: 1;
        color: var(--text-color-light);
      }

      .content-area {
        flex-grow: 1;
        pointer-events: auto;
        padding: 20px 30px 15px 30px;
      }
      .projects-list {
        padding: 20px 30px 15px 30px;
        flex-grow: 1;
      }

      .profile-pic {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        margin: 0 auto 20px auto;
        display: block;
        object-fit: cover;
        border: 2px solid var(--border-color-light);
      }

      .fluent-card-content h1 {
        text-align: center;
        margin-top: 0;
        margin-bottom: 10px;
        font-size: 28px;
        font-weight: 600;
        color: var(--heading-color-light);
      }

      .intro-text {
        margin-top: 0;
        margin-bottom: 15px;
        font-size: 15px;
        line-height: 1.6;
        color: var(--subtle-text-light);
      }

      .fluent-card-content h2 {
        font-size: 20px;
        font-weight: 600;
        color: var(--heading-color-light);
        margin-top: 25px;
        margin-bottom: 10px;
        padding-bottom: 5px;
        border-bottom: 1px solid var(--border-color-light);
      }

      .fluent-card-content ul {
        list-style: none;
        padding-left: 0;
        margin-top: 0;
        margin-bottom: 15px;
      }

      .fluent-card-content li {
        margin-bottom: 8px;
        font-size: 15px;
        color: var(--subtle-text-light);
        padding-left: 1em;
        position: relative;
      }
      .fluent-card-content li::before {
        content: "•";
        color: var(--link-color-light);
        display: inline-block;
        position: absolute;
        left: 0;
        top: 0;
      }

      .tech-details {
        font-size: 14px;
        color: #555;
        line-height: 1.5;
        margin-bottom: 20px;
      }

      .scrolling-icons-container {
        width: 100%;
        overflow: hidden;
        margin-bottom: 20px;
      }

      .scrolling-icons-track {
        display: flex;
        width: fit-content;
        align-items: center;
        animation: scrollIcons var(--scroll-duration) linear infinite;
        will-change: transform;
      }

      .scrolling-icons-container:hover .scrolling-icons-track {
        animation-play-state: paused;
      }

      .scrolling-icons-track img {
        height: 32px;
        width: auto;
        margin: 0 22px;
        flex-shrink: 0;
        object-fit: contain;
        vertical-align: middle;
        pointer-events: none;
        user-select: none;
        filter: brightness(1);
      }

      @keyframes scrollIcons {
        0% {
          transform: translateX(0%);
        }
        100% {
          transform: translateX(-50%);
        }
      }

      @media (prefers-reduced-motion: reduce) {
        .scrolling-icons-track {
          animation: none;
        }
      }

      .links-section {
        padding: 15px 30px;
        border-top: 1px solid var(--section-separator-light);
        text-align: center;
        flex-shrink: 0;
        background-color: var(--handle-bg-light);
        position: relative;
        z-index: 5;
      }

      .fluent-button {
        display: inline-block;
        margin: 5px 5px;
        padding: 10px 20px;
        font-size: 15px;
        font-weight: 600;
        background-color: var(--button-bg-light);
        border: 1px solid var(--button-bg-light);
        border-radius: 4px;
        color: var(--button-text-light);
        text-decoration: none;
        cursor: pointer;
        transition: background-color 0.2s ease, border-color 0.2s ease,
          box-shadow 0.2s ease, color 0.2s ease;
      }

      .fluent-button:hover {
        background-color: var(--button-hover-bg-light);
        border-color: var(--button-hover-bg-light);
        color: var(--button-text-light);
        text-decoration: none;
        box-shadow: 0 2px 5px var(--shadow-color-light);
      }

      .fluent-button:active {
        background-color: var(--button-active-bg-light);
        border-color: var(--button-active-bg-light);
        color: var(--button-text-light);
        box-shadow: none;
      }

      .resize-handle {
        position: absolute;
        bottom: 0;
        right: 0;
        width: 15px;
        height: 15px;
        background: repeating-linear-gradient(
          -45deg,
          var(--resize-handle-fill-light),
          var(--resize-handle-fill-light) 2px,
          transparent 2px,
          transparent 4px
        );
        cursor: nwse-resize;
        border-top: 1px solid var(--resize-handle-border-light);
        border-left: 1px solid var(--resize-handle-border-light);
        z-index: 10;
        touch-action: none;
      }

      #reopenAboutMeBtn {
        position: fixed;
        bottom: 20px;
        left: 20px;
        padding: 8px 15px;
        background-color: var(--reopen-button-bg-light);
        color: var(--reopen-button-text-light);
        border: 1px solid var(--border-color-light);
        border-radius: 4px;
        cursor: pointer;
        z-index: 1000;
        box-shadow: 0 2px 5px var(--shadow-color-light);
        backdrop-filter: blur(5px);
        -webkit-backdrop-filter: blur(5px);
        font-size: 14px;
      }

      #copyright-info {
        position: fixed;
        bottom: 5px;
        right: 10px;
        font-size: 10px;
        color: var(--copyright-text-light);
        background-color: var(--copyright-bg-light);
        padding: 2px 6px;
        border-radius: 3px;
        z-index: 0;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);
        max-width: 40%;
        text-align: right;
        pointer-events: none;
      }

      .projects-list ul {
        list-style: none;
        padding: 0;
        margin: 0;
      }
      .projects-list li {
        margin-bottom: 25px;
        padding-bottom: 15px;
        border-bottom: 1px solid var(--section-separator-light);
      }
      .projects-list li:last-child {
        margin-bottom: 0;
        padding-bottom: 0;
        border-bottom: none;
      }
      .project-title {
        margin-top: 0;
        margin-bottom: 5px;
        font-size: 18px;
        font-weight: 600;
      }
      .project-title a {
        color: var(--link-color-light);
        text-decoration: none;
      }
      .project-title a:hover {
        color: var(--link-hover-light);
        text-decoration: underline;
      }
      .project-visibility {
        font-size: 0.75em;
        font-weight: normal;
        color: var(--subtle-text-light);
        border: 1px solid var(--border-color-light);
        border-radius: 3px;
        padding: 1px 4px;
        margin-left: 8px;
        vertical-align: middle;
      }
      .project-desc {
        font-size: 14px;
        margin-top: 0;
        margin-bottom: 10px;
        color: var(--subtle-text-light);
      }
      .project-tags span {
        display: inline-block;
        background-color: var(--handle-bg-light);
        color: var(--link-color-light);
        padding: 2px 6px;
        border-radius: 4px;
        font-size: 12px;
        margin-right: 5px;
        margin-bottom: 5px;
      }
      .project-meta {
        font-size: 13px;
        color: var(--subtle-text-light);
        margin-top: 10px;
      }
      .project-meta span {
        margin-right: 15px;
        display: inline-flex;
        align-items: center;
      }
      .project-lang::before {
        content: "●";
        margin-right: 5px;
        font-size: 1.2em;
        line-height: 1;
      }
      .project-lang.csharp::before {
        color: #9b4f96;
      }
      .project-lang.cpp::before,
      .project-lang.c::before {
        color: #555555;
      }
      .project-lang.java::before {
        color: #b07219;
      }
      .project-lang.lua::before {
        color: #2c2d72;
      }
      .project-lang.other::before {
        color: #888888;
      }
      .project-lang.na::before {
        display: none;
      }
      .project-license::before {
        content: "⚖️";
        margin-right: 5px;
        font-size: 0.9em;
      }
      .project-issues::before {
        content: "⚠️";
        margin-right: 5px;
        font-size: 0.9em;
      }

      .loading-message,
      .error-message {
        padding: 20px;
        text-align: center;
        color: var(--subtle-text-light);
      }

      @media (prefers-color-scheme: dark) {
        body {
          color: var(--text-color-dark);
          background-color: #1c1c1c;
        }

        .fluent-card {
          background: var(--card-bg-dark);
          border-color: var(--border-color-dark);
          box-shadow: 0 8px 30px var(--shadow-color-dark);
        }

        .drag-handle {
          background-color: var(--handle-bg-dark);
          border-color: var(--border-color-dark);
        }

        .drag-handle h1.handle-title {
          color: var(--heading-color-dark);
        }
        .drag-handle img.handle-pic {
          border-color: var(--border-color-dark);
        }

        .window-button {
          color: var(--window-button-text-dark);
        }
        .window-button:not(:disabled):hover {
          background-color: var(--window-button-hover-bg-dark);
        }
        .window-button.close:not(:disabled):hover {
          background-color: var(--window-button-close-hover-bg-dark);
          color: var(--window-button-close-hover-text-dark);
        }

        .fluent-card-content {
          color: var(--text-color-dark);
        }
        .profile-pic {
          border-color: var(--border-color-dark);
        }

        .fluent-card-content h1 {
          color: var(--heading-color-dark);
        }
        .intro-text {
          color: var(--subtle-text-dark);
        }
        .fluent-card-content h2 {
          color: var(--heading-color-dark);
          border-color: var(--border-color-dark);
        }
        .fluent-card-content li {
          color: var(--subtle-text-dark);
        }
        .fluent-card-content li::before {
          color: var(--link-color-dark);
        }
        .tech-details {
          color: #a0a0a0;
        }

        .links-section {
          border-color: var(--section-separator-dark);
          background-color: var(--handle-bg-dark);
        }

        .scrolling-icons-track img {
          filter: brightness(0.9);
        }

        .fluent-button {
          background-color: var(--button-bg-dark);
          border-color: var(--button-bg-dark);
          color: var(--button-text-dark);
        }
        .fluent-button:hover {
          background-color: var(--button-hover-bg-dark);
          border-color: var(--button-hover-bg-dark);
          color: var(--button-text-dark);
          box-shadow: 0 2px 5px var(--shadow-color-dark);
        }
        .fluent-button:active {
          background-color: var(--button-active-bg-dark);
          border-color: var(--button-active-bg-dark);
          color: var(--button-text-dark);
        }
        .resize-handle {
          background: repeating-linear-gradient(
            -45deg,
            var(--resize-handle-fill-dark),
            var(--resize-handle-fill-dark) 2px,
            transparent 2px,
            transparent 4px
          );
          border-top-color: var(--resize-handle-border-dark);
          border-left-color: var(--resize-handle-border-dark);
        }

        #reopenAboutMeBtn {
          background-color: var(--reopen-button-bg-dark);
          color: var(--reopen-button-text-dark);
          border-color: var(--border-color-dark);
          box-shadow: 0 2px 5px var(--shadow-color-dark);
        }

        #copyright-info {
          background-color: var(--copyright-bg-dark);
          color: var(--copyright-text-dark);
          text-shadow: none;
        }

        .projects-list li {
          border-bottom-color: var(--section-separator-dark);
        }
        .project-title a {
          color: var(--link-color-dark);
        }
        .project-title a:hover {
          color: var(--link-hover-dark);
        }
        .project-visibility {
          color: var(--subtle-text-dark);
          border-color: var(--border-color-dark);
        }
        .project-desc {
          color: var(--subtle-text-dark);
        }
        .project-tags span {
          background-color: var(--handle-bg-dark);
          color: var(--link-color-dark);
        }
        .project-meta {
          color: var(--subtle-text-dark);
        }
        .project-lang.csharp::before {
          color: #d8a0df;
        }
        .project-lang.cpp::before,
        .project-lang.c::before {
          color: #cccccc;
        }
        .project-lang.java::before {
          color: #f1e05a;
        }
        .project-lang.lua::before {
          color: #7e80d4;
        }
        .project-lang.other::before {
          color: #aaaaaa;
        }

        .loading-message,
        .error-message {
          color: var(--subtle-text-dark);
        }
      }
    </style>
  </head>
  <body>
    <button id="reopenAboutMeBtn">About Me</button>
    <div id="copyright-info"></div>

    <script>
      const windows = {};
      let highestZ = 1;
      let activeInteractionWindow = null;
      let dynamicStyleTag = null;

      const GITHUB_USERNAME = "megabytesme";
      const BACKEND_API_BASE_URL = "https://megabytesme.ddns.net";

      const minWidth = parseInt(
        getComputedStyle(document.documentElement).getPropertyValue(
          "--min-card-width"
        ) || "320",
        10
      );
      const minHeight = parseInt(
        getComputedStyle(document.documentElement).getPropertyValue(
          "--min-card-height"
        ) || "400",
        10
      );

      class FluentWindow {
        constructor(id, title, titleIconUrl, contentHtml, options = {}) {
          this.id = id;
          this.isDragging = false;
          this.isResizing = false;
          this.positionedWithTopLeft = false;
          this.dragOffsetX = 0;
          this.dragOffsetY = 0;
          this.resizeInitialMouseX = 0;
          this.resizeInitialMouseY = 0;
          this.initialWidth = 0;
          this.initialHeight = 0;
          this.initialCardX_resize = 0;
          this.initialCardY_resize = 0;

          this.element = this._createWindowElement(
            id,
            title,
            titleIconUrl,
            options.footerHtml
          );
          this.contentContainer = this.element.querySelector(
            ".fluent-card-content"
          );
          this.dragHandle = this.element.querySelector(".drag-handle");
          this.resizeHandle = this.element.querySelector(".resize-handle");
          this.closeButton = this.element.querySelector(".window-button.close");

          this.setContent(contentHtml);
          this._attachEventListeners();
          this._setInitialPosition(options.initialOffset);
          this.bringToFront();
        }

        setContent(html) {
          if (this.contentContainer) {
            this.contentContainer.innerHTML = html;
          }
        }

        _createWindowElement(id, title, titleIconUrl, footerHtml = "") {
          const card = document.createElement("div");
          card.className = "fluent-card";
          card.id = `window-${id}`;

          let footerSection = "";
          if (footerHtml) {
            footerSection = `<div class="links-section">${footerHtml}</div>`;
          }

          card.innerHTML = `
                    <div class="drag-handle">
                         <img src="${
                           titleIconUrl || "https://via.placeholder.com/20"
                         }" alt="Window Icon" class="handle-pic">
                         <h1 class="handle-title">${title}</h1>
                         <div class="window-controls">
                             <button class="window-button minimize" disabled aria-hidden="true">–</button>
                             <button class="window-button maximize" disabled aria-hidden="true">▢</button>
                             <button class="window-button close" aria-label="Close ${title}">✕</button>
                         </div>
                    </div>
                    <div class="fluent-card-content"></div>
                    ${footerSection}
                    <div class="resize-handle"></div>
                `;
          document.body.appendChild(card);
          return card;
        }

        _setInitialPosition(offset = { x: 0, y: 0 }) {
          requestAnimationFrame(() => {
            if (this.positionedWithTopLeft) return;

            const cardWidth = this.element.offsetWidth;
            const cardHeight = this.element.offsetHeight;
            const viewportWidth = document.documentElement.clientWidth;
            const viewportHeight = document.documentElement.clientHeight;
            const isDuoLayout = window.matchMedia(
              "(screen-spanning: single-fold-vertical)"
            ).matches;

            let initialLeft, initialTop;

            if (isDuoLayout) {
              const computedStyle = getComputedStyle(this.element);
              initialLeft = parseFloat(computedStyle.left) || 10;
              initialTop = parseFloat(computedStyle.top) || 10;
              this.element.style.transform = "none";
            } else {
              initialLeft =
                Math.max(0, (viewportWidth - cardWidth) / 2) + offset.x;
              initialTop =
                Math.max(0, (viewportHeight - cardHeight) / 2) + offset.y;
              this.element.style.transform = "none";
            }

            if (initialLeft < 0) initialLeft = 0;
            if (initialTop < 0) initialTop = 0;
            if (initialLeft > viewportWidth - cardWidth)
              initialLeft = viewportWidth - cardWidth;
            if (initialTop > viewportHeight - cardHeight)
              initialTop = viewportHeight - cardHeight;

            this.element.style.left = `${initialLeft}px`;
            this.element.style.top = `${initialTop}px`;
            this.positionedWithTopLeft = true;
          });
        }

        _attachEventListeners() {
          this.dragHandle.addEventListener(
            "mousedown",
            this._startDrag.bind(this)
          );
          this.dragHandle.addEventListener(
            "touchstart",
            this._startDrag.bind(this),
            { passive: false }
          );

          this.resizeHandle.addEventListener(
            "mousedown",
            this._startResize.bind(this)
          );
          this.resizeHandle.addEventListener(
            "touchstart",
            this._startResize.bind(this),
            { passive: false }
          );

          this.element.addEventListener(
            "mousedown",
            this.bringToFront.bind(this)
          );
          this.element.addEventListener(
            "touchstart",
            this.bringToFront.bind(this),
            { passive: false }
          );

          this.closeButton.addEventListener("click", this.destroy.bind(this));

          const footer = this.element.querySelector(".links-section");
          if (footer) {
            footer.addEventListener("click", (e) => {
              if (e.target.classList.contains("view-projects-button")) {
                e.stopPropagation();
                createProjectsWindow();
              } else if (e.target.classList.contains("close-window-button")) {
                e.stopPropagation();
                this.destroy();
              } else if (
                e.target.classList.contains("some-other-action-button")
              ) {
                e.stopPropagation();
                alert(`Button in window '${this.id}' clicked!`);
              }
            });
          }
        }

        bringToFront() {
          highestZ++;
          this.element.style.zIndex = highestZ;
        }

        _switchToTopLeftPositioningIfNeeded() {
          if (!this.positionedWithTopLeft) {
            this._setInitialPosition();
          }
        }

        _startDrag(e) {
          if (
            this.isResizing ||
            e.target === this.resizeHandle ||
            e.target.closest(".window-controls") ||
            e.target.closest(".fluent-button")
          )
            return;
          if (e.target !== this.dragHandle && !e.target.closest(".drag-handle"))
            return;

          this._switchToTopLeftPositioningIfNeeded();
          this.bringToFront();

          this.isDragging = true;
          activeInteractionWindow = this;
          this.dragHandle.style.cursor = "grabbing";
          document.body.style.cursor = "grabbing";

          const rect = this.element.getBoundingClientRect();
          let startClientX, startClientY;

          if (e.type === "touchstart") {
            startClientX = e.touches[0].clientX;
            startClientY = e.touches[0].clientY;
          } else {
            startClientX = e.clientX;
            startClientY = e.clientY;
          }

          this.dragOffsetX = startClientX - rect.left;
          this.dragOffsetY = startClientY - rect.top;

          e.preventDefault();
        }

        _doDrag(e) {
          if (!this.isDragging) return;
          e.preventDefault();

          let currentMouseX, currentMouseY;
          if (e.type === "touchmove") {
            currentMouseX = e.touches[0].clientX;
            currentMouseY = e.touches[0].clientY;
          } else {
            currentMouseX = e.clientX;
            currentMouseY = e.clientY;
          }

          let newCardX = currentMouseX - this.dragOffsetX;
          let newCardY = currentMouseY - this.dragOffsetY;

          const viewportWidth = document.documentElement.clientWidth;
          const viewportHeight = document.documentElement.clientHeight;
          const cardWidth = this.element.offsetWidth;
          const cardHeight = this.element.offsetHeight;

          if (newCardX < 0) newCardX = 0;
          if (newCardY < 0) newCardY = 0;
          if (newCardX > viewportWidth - cardWidth)
            newCardX = viewportWidth - cardWidth;
          if (newCardY > viewportHeight - cardHeight)
            newCardY = viewportHeight - cardHeight;

          this.element.style.left = `${newCardX}px`;
          this.element.style.top = `${newCardY}px`;
        }

        _endDrag() {
          if (this.isDragging) {
            this.isDragging = false;
            this.dragHandle.style.cursor = "grab";
            if (activeInteractionWindow === this) {
              activeInteractionWindow = null;
              document.body.style.cursor = "default";
            }
          }
        }

        _startResize(e) {
          if (this.isDragging) return;

          this._switchToTopLeftPositioningIfNeeded();
          this.bringToFront();

          this.isResizing = true;
          activeInteractionWindow = this;
          document.body.style.cursor = "nwse-resize";

          this.initialWidth = this.element.offsetWidth;
          this.initialHeight = this.element.offsetHeight;
          this.initialCardX_resize = this.element.offsetLeft;
          this.initialCardY_resize = this.element.offsetTop;

          if (e.type === "touchstart") {
            this.resizeInitialMouseX = e.touches[0].clientX;
            this.resizeInitialMouseY = e.touches[0].clientY;
          } else {
            this.resizeInitialMouseX = e.clientX;
            this.resizeInitialMouseY = e.clientY;
          }
          e.preventDefault();
        }

        _doResize(e) {
          if (!this.isResizing) return;
          e.preventDefault();

          let currentMouseX, currentMouseY;
          if (e.type === "touchmove") {
            currentMouseX = e.touches[0].clientX;
            currentMouseY = e.touches[0].clientY;
          } else {
            currentMouseX = e.clientX;
            currentMouseY = e.clientY;
          }

          let dx = currentMouseX - this.resizeInitialMouseX;
          let dy = currentMouseY - this.resizeInitialMouseY;

          let newWidth = this.initialWidth + dx;
          let newHeight = this.initialHeight + dy;

          newWidth = Math.max(minWidth, newWidth);
          newHeight = Math.max(minHeight, newHeight);

          const viewportWidth = document.documentElement.clientWidth;
          const viewportHeight = document.documentElement.clientHeight;

          if (this.initialCardX_resize + newWidth > viewportWidth) {
            newWidth = viewportWidth - this.initialCardX_resize;
            newWidth = Math.max(minWidth, newWidth);
          }
          if (this.initialCardY_resize + newHeight > viewportHeight) {
            newHeight = viewportHeight - this.initialCardY_resize;
            newHeight = Math.max(minHeight, newHeight);
          }

          this.element.style.width = `${newWidth}px`;
          this.element.style.height = `${newHeight}px`;
        }

        _endResize() {
          if (this.isResizing) {
            this.isResizing = false;
            if (activeInteractionWindow === this) {
              activeInteractionWindow = null;
              document.body.style.cursor = "default";
            }
          }
        }

        destroy() {
          this.element.remove();
          delete windows[this.id];
          if (activeInteractionWindow === this) {
            activeInteractionWindow = null;
            document.body.style.cursor = "default";
          }
        }
      }

      document.addEventListener("mousemove", (e) => {
        activeInteractionWindow?._doDrag(e);
        activeInteractionWindow?._doResize(e);
      });
      document.addEventListener(
        "touchmove",
        (e) => {
          activeInteractionWindow?._doDrag(e);
          activeInteractionWindow?._doResize(e);
        },
        { passive: false }
      );

      document.addEventListener("mouseup", () => {
        activeInteractionWindow?._endDrag();
        activeInteractionWindow?._endResize();
      });
      document.addEventListener("touchend", () => {
        activeInteractionWindow?._endDrag();
        activeInteractionWindow?._endResize();
      });

      function createWindow(
        id,
        title,
        titleIconUrl,
        contentHtml,
        options = {}
      ) {
        if (windows[id]) {
          windows[id].bringToFront();
          return windows[id];
        }
        const newWindow = new FluentWindow(
          id,
          title,
          titleIconUrl,
          contentHtml,
          options
        );
        windows[id] = newWindow;
        return newWindow;
      }

      async function fetchProjects(username) {
        const apiUrl = `https://api.github.com/users/${username}/repos?sort=updated&per_page=20`;
        try {
          const response = await fetch(apiUrl);
          if (!response.ok) {
            if (response.status === 403)
              throw new Error("GitHub API rate limit exceeded.");
            throw new Error(`GitHub API error! status: ${response.status}`);
          }
          const data = await response.json();
          return data;
        } catch (error) {
          console.error("Error fetching projects:", error);
          throw error;
        }
      }

      function formatDate(isoString) {
        if (!isoString) return "N/A";
        try {
          return new Date(isoString).toLocaleDateString(undefined, {
            year: "numeric",
            month: "short",
            day: "numeric",
          });
        } catch (e) {
          return "Invalid Date";
        }
      }

      function renderProjects(repos, containerElement) {
        containerElement.innerHTML = "";
        if (!repos || repos.length === 0) {
          containerElement.innerHTML =
            '<p class="error-message">No public projects found or failed to load.</p>';
          return;
        }
        const list = document.createElement("ul");
        repos.forEach((repo) => {
          const li = document.createElement("li");
          const tags =
            repo.topics?.map((t) => `<span>${t}</span>`).join(" ") || "";
          const license = repo.license
            ? `<span class="project-license">${repo.license.name}</span>`
            : "";
          const lang = repo.language
            ? `<span class="project-lang ${repo.language
                .toLowerCase()
                .replace(/[^a-z0-9]/g, "")}">${repo.language}</span>`
            : '<span class="project-lang na">N/A</span>';
          li.innerHTML = `<h3 class="project-title"><a href="${
            repo.html_url
          }" target="_blank" rel="noopener noreferrer">${
            repo.name
          }</a> <span class="project-visibility">Public</span></h3>
                                <p class="project-desc">${
                                  repo.description || "No description."
                                }</p>
                                <div class="project-tags">${tags}</div>
                                <div class="project-meta">${lang}${license}<span class="project-date">Updated ${formatDate(
            repo.updated_at
          )}</span></div>`;
          list.appendChild(li);
        });
        containerElement.appendChild(list);
      }

      function displayError(error, containerElement) {
        containerElement.innerHTML = `<p class="error-message">Error loading projects: ${
          error.message || "Unknown error"
        }</p>`;
      }

      const aboutMeContent = `
             <div class="content-area">
                <img src="https://avatars.githubusercontent.com/u/57240557?v=4" alt="Profile Picture" class="profile-pic">
                <h1>MegaBytesMe (Ben)</h1>
                <p class="intro-text">
                    Hey! 👋🏻<br>
                    I'm Ben, a student and developer with a passion for trying out new areas of software development, from utilities, webapps and modding games to university projects and desktop applications.
                </p>
                <p class="intro-text">
                   I have a keen interest on unique platforms (ranging from Windows 10 Mobile to the Nintendo Wii U) - They hold a special place to me for some reason 😂. Beyond software development, I also have an interest in electronics, cars and DIY.
                </p>
                <h2>Technologies & Languages</h2>
                <p>I primarily work with:</p>
                <ul><li>C#</li><li>C++</li><li>Java</li><li>Lua</li><li>TypeScript</li></ul>
                <p class="tech-details">
                    I have also tinkered with technologies and concepts such as .NET, React, CMake, Docker, JBeam (BeamNG.drive's vehicle description language), and various game modding APIs including Fabric (Minecraft) alongside working with RGB SDKs (Primarily iCue). I also have worked with cloud services - Beyond AWS, I also have my own cloud instance too which I run containers on.
                </p>
                <h2>Technologies I have worked with:</h2>
                <div class="scrolling-icons-container">
                    <div class="scrolling-icons-track">
                         <img src="https://edent.github.io/SuperTinyIcons/images/svg/visualstudiocode.svg" alt="Visual Studio Code logo"><img src="https://tech-stack-icons.com/assets/light/csharp.svg" alt="C# logo"><img src="https://tech-stack-icons.com/assets/light/c++.svg" alt="C++ logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/java.svg" alt="Java logo"><img src="https://tech-stack-icons.com/assets/light/lua.svg" alt="Lua logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/typescript.svg" alt="TypeScript logo"><img src="https://tech-stack-icons.com/assets/light/python.svg" alt="Python logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/react.svg" alt="React logo"><img src="https://tech-stack-icons.com/assets/light/html5.svg" alt="HTML5 logo"><img src="https://tech-stack-icons.com/assets/light/css3.svg" alt="CSS3 logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/microsoft.svg" alt="Microsoft logo"><img src="https://tech-stack-icons.com/assets/light/git.svg" alt="Git logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/gitlab.svg" alt="GitLab logo"><img src="https://tech-stack-icons.com/assets/light/github.svg" alt="GitHub logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/docker.svg" alt="Docker logo"><img src="https://tech-stack-icons.com/assets/light/aws.svg" alt="AWS logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/azure.svg" alt="Microsoft Azure logo"><img src="https://tech-stack-icons.com/assets/light/postgresql.svg" alt="PostgreSQL logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/terraform.svg" alt="Terraform logo"><img src="https://tech-stack-icons.com/assets/light/npm.svg" alt="NPM logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/slack.svg" alt="Slack logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/zoom.svg" alt="Zoom logo"><img src="https://tech-stack-icons.com/assets/light/onedrive.svg" alt="OneDrive logo">
                         <img src="https://edent.github.io/SuperTinyIcons/images/svg/visualstudiocode.svg" alt="Visual Studio Code logo"><img src="https://tech-stack-icons.com/assets/light/csharp.svg" alt="C# logo"><img src="https://tech-stack-icons.com/assets/light/c++.svg" alt="C++ logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/java.svg" alt="Java logo"><img src="https://tech-stack-icons.com/assets/light/lua.svg" alt="Lua logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/typescript.svg" alt="TypeScript logo"><img src="https://tech-stack-icons.com/assets/light/python.svg" alt="Python logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/react.svg" alt="React logo"><img src="https://tech-stack-icons.com/assets/light/html5.svg" alt="HTML5 logo"><img src="https://tech-stack-icons.com/assets/light/css3.svg" alt="CSS3 logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/microsoft.svg" alt="Microsoft logo"><img src="https://tech-stack-icons.com/assets/light/git.svg" alt="Git logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/gitlab.svg" alt="GitLab logo"><img src="https://tech-stack-icons.com/assets/light/github.svg" alt="GitHub logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/docker.svg" alt="Docker logo"><img src="https://tech-stack-icons.com/assets/light/aws.svg" alt="AWS logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/azure.svg" alt="Microsoft Azure logo"><img src="https://tech-stack-icons.com/assets/light/postgresql.svg" alt="PostgreSQL logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/terraform.svg" alt="Terraform logo"><img src="https://tech-stack-icons.com/assets/light/npm.svg" alt="NPM logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/slack.svg" alt="Slack logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/zoom.svg" alt="Zoom logo"><img src="https://tech-stack-icons.com/assets/light/onedrive.svg" alt="OneDrive logo">
                    </div>
                 </div>
            </div>
        `;
      const aboutMeFooter = `
             <button class="fluent-button view-projects-button">View Projects</button>
             <a href="https://github.com/megabytesme" target="_blank" rel="noopener noreferrer" class="fluent-button">GitHub</a>
         `;

      const projectsInitialContent = `<div class="projects-list"><p class="loading-message">Loading projects...</p></div>`;
      const projectsFooter = `<button class="fluent-button close-window-button">Close Projects</button>`;

      async function createProjectsWindow() {
        const windowId = "projects";
        if (windows[windowId]) {
          windows[windowId].bringToFront();
          return;
        }

        const existingWindowCount = Object.keys(windows).length;
        const offsetX = 30 * existingWindowCount;
        const offsetY = 30 * existingWindowCount;

        const projectsWindow = createWindow(
          windowId,
          "My Projects",
          "https://git-scm.com/images/logos/downloads/Git-Icon-White.svg",
          projectsInitialContent,
          {
            footerHtml: projectsFooter,
            initialOffset: { x: offsetX, y: offsetY },
          }
        );

        const projectsListContainer =
          projectsWindow.element.querySelector(".projects-list");
        try {
          const repos = await fetchProjects(GITHUB_USERNAME);
          renderProjects(repos, projectsListContainer);
        } catch (error) {
          displayError(error, projectsListContainer);
        }
      }

      function createAboutMeWindow() {
        createWindow(
          "about-me",
          "About Me - Ben",
          "https://avatars.githubusercontent.com/u/57240557?v=4",
          aboutMeContent,
          { footerHtml: aboutMeFooter }
        );
      }

      const reopenBtn = document.getElementById("reopenAboutMeBtn");
      if (reopenBtn) {
        reopenBtn.addEventListener("click", createAboutMeWindow);
      }

      async function fetchSpotlightData() {
        const apiUrl = `${BACKEND_API_BASE_URL}/api/spotlight-data`;
        try {
          const response = await fetch(apiUrl);
          if (!response.ok) {
            throw new Error(
              `Cache Service HTTP error! status: ${response.status}`
            );
          }
          const data = await response.json();
          applySpotlightBackground(data);
        } catch (error) {
          console.error("Failed to fetch cached Spotlight data:", error);
          const copyrightDiv = document.getElementById("copyright-info");
          if (copyrightDiv)
            copyrightDiv.textContent = "Error loading background info.";
        }
      }

      function applySpotlightBackground(cachedItems) {
        try {
          if (
            !cachedItems ||
            !Array.isArray(cachedItems) ||
            cachedItems.length === 0
          ) {
            console.warn("Received empty or invalid cache data.");
            return;
          }

          const randomIndex = Math.floor(Math.random() * cachedItems.length);
          const selectedItem = cachedItems[randomIndex];

          const landscapePath = selectedItem?.landscapePath;
          const portraitPath = selectedItem?.portraitPath;
          const copyrightText = selectedItem?.copyright || "";
          const title = selectedItem?.title || "";

          if (!landscapePath || !portraitPath) {
            console.warn(
              "Selected cached item missing image paths:",
              selectedItem
            );
            return;
          }

          const fullLandscapeUrl = `${BACKEND_API_BASE_URL}/cached-images/${landscapePath}`;
          const fullPortraitUrl = `${BACKEND_API_BASE_URL}/cached-images/${portraitPath}`;

          document.documentElement.style.setProperty(
            "--bg-image-landscape",
            `url('${fullLandscapeUrl}')`
          );
          document.documentElement.style.setProperty(
            "--bg-image-portrait",
            `url('${fullPortraitUrl}')`
          );

          const copyrightDiv = document.getElementById("copyright-info");
          if (copyrightDiv) {
            let displayText = copyrightText.trim();
            if (
              title &&
              displayText &&
              !displayText.toLowerCase().includes(title.toLowerCase())
            ) {
              displayText = `${title} | ${displayText}`;
            } else if (title && !displayText) {
              displayText = title;
            }
            copyrightDiv.textContent =
              displayText || "Image information unavailable";
          }
        } catch (error) {
          console.error("Error applying cached Spotlight data:", error);
          const copyrightDiv = document.getElementById("copyright-info");
          if (copyrightDiv)
            copyrightDiv.textContent = "Error displaying image info.";
        }
      }

      document.addEventListener("DOMContentLoaded", () => {
        fetchSpotlightData();
        createAboutMeWindow();
      });
    </script>
  </body>
</html>
