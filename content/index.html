<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0"
    />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="color-scheme" content="dark light" />
    <title>MegaBytesMe - Ben</title>
    <style>
      body,
      html {
        margin: 0;
        padding: 0;
        height: 100%;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        box-sizing: border-box;
        overflow: hidden;
      }
      *,
      *:before,
      *:after {
        box-sizing: inherit;
      }

      body {
        background: none no-repeat center center fixed;
        background-size: cover;
        color: #f0f0f0;
        background-color: #1c1c1c;
      }

      @media (orientation: portrait) {
        body {
          background-image: none;
        }
      }

      .fluent-card {
        position: absolute;
        width: 90%;
        max-width: 600px;
        min-width: 320px;
        height: 75vh;
        max-height: 95vh;
        min-height: 400px;
        padding: 0;
        background: rgba(40, 40, 40, 0.9);
        border-radius: 8px;
        border: 1px solid rgba(255, 255, 255, 0.15);
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
        text-align: left;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        cursor: default;
        z-index: 1;
      }

      .drag-handle {
        padding: 6px 5px 6px 15px;
        cursor: grab;
        background-color: rgba(255, 255, 255, 0.08);
        border-bottom: 1px solid rgba(255, 255, 255, 0.15);
        user-select: none;
        -webkit-user-select: none;
        -ms-user-select: none;
        touch-action: none;
        display: flex;
        align-items: center;
        flex-shrink: 0;
        position: relative;
        z-index: 20;
      }
      .drag-handle img.handle-pic {
        width: 20px;
        height: 20px;
        border-radius: 50%;
        flex-shrink: 0;
        border: 1px solid rgba(255, 255, 255, 0.15);
        margin-right: 10px;
      }
      .drag-handle h1.handle-title {
        margin: 0;
        font-size: 15px;
        font-weight: 600;
        line-height: 1.4;
        color: #ffffff;
        flex-grow: 1;
        pointer-events: none;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        margin-right: 10px;
      }

      .window-controls {
        display: flex;
        align-items: center;
        flex-shrink: 0;
        margin-left: auto;
      }

      .window-button {
        -webkit-appearance: none;
        -ms-appearance: none;
        appearance: none;
        background: none;
        border: none;
        padding: 0;
        margin: 0 1px;
        width: 34px;
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 16px;
        line-height: 1;
        color: #f0f0f0;
        cursor: pointer;
        pointer-events: auto;
        transition: background-color 0.1s ease;
        font-family: "Segoe UI Symbol", sans-serif;
        border-radius: 2px;
      }
      .window-button:disabled {
        opacity: 0.5;
        cursor: default;
        pointer-events: none;
      }
      .window-button:not(:disabled):hover {
        background-color: rgba(255, 255, 255, 0.15);
      }
      .window-button.close:not(:disabled):hover {
        background-color: #e81123;
        color: white;
      }

      .fluent-card-content {
        padding: 0;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
        flex-grow: 1;
        position: relative;
        z-index: 1;
        color: #f0f0f0;
      }

      .content-area {
        flex-grow: 1;
        pointer-events: auto;
        padding: 20px 30px 15px 30px;
      }
      .projects-list {
        padding: 20px 30px 15px 30px;
        flex-grow: 1;
      }

      .profile-pic {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        margin: 0 auto 20px auto;
        display: block;
        border: 2px solid rgba(255, 255, 255, 0.15);
      }

      .fluent-card-content h1 {
        text-align: center;
        margin-top: 0;
        margin-bottom: 10px;
        font-size: 28px;
        font-weight: 600;
        color: #ffffff;
      }

      .intro-text {
        margin-top: 0;
        margin-bottom: 15px;
        font-size: 15px;
        line-height: 1.6;
        color: #cccccc;
      }

      .fluent-card-content h2 {
        font-size: 20px;
        font-weight: 600;
        color: #ffffff;
        margin-top: 25px;
        margin-bottom: 10px;
        padding-bottom: 5px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.15);
      }

      .fluent-card-content ul {
        list-style: none;
        padding-left: 0;
        margin-top: 0;
        margin-bottom: 15px;
      }

      .fluent-card-content li {
        margin-bottom: 8px;
        font-size: 15px;
        color: #cccccc;
        padding-left: 1em;
        position: relative;
      }
      .fluent-card-content li::before {
        content: "•";
        color: #2899f5;
        display: inline-block;
        position: absolute;
        left: 0;
        top: 0;
      }

      .tech-details {
        font-size: 14px;
        color: #a0a0a0;
        line-height: 1.5;
        margin-bottom: 20px;
      }

      .scrolling-icons-container {
        width: 100%;
        overflow: hidden;
        margin-bottom: 20px;
      }

      .scrolling-icons-track {
        display: flex;
        align-items: center;
        animation: scrollIcons 14s linear infinite;
      }
      .scrolling-icons-container:hover .scrolling-icons-track {
        animation-play-state: paused;
      }
      .scrolling-icons-track img {
        height: 32px;
        width: auto;
        margin: 0 22px;
        flex-shrink: 0;
        vertical-align: middle;
        pointer-events: none;
        user-select: none;
        -webkit-user-select: none;
        -ms-user-select: none;
        filter: brightness(0.9);
      }

      @keyframes scrollIcons {
        0% {
          transform: translateX(0%);
        }
        100% {
          transform: translateX(-50%);
        }
      }
      @media (prefers-reduced-motion: reduce) {
        .scrolling-icons-track {
          animation: none;
        }
      }

      .links-section {
        padding: 15px 30px;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        text-align: center;
        flex-shrink: 0;
        background-color: rgba(255, 255, 255, 0.08);
        position: relative;
        z-index: 5;
      }

      .fluent-button {
        display: inline-block;
        margin: 5px 5px;
        padding: 10px 20px;
        font-size: 15px;
        font-weight: 600;
        background-color: #2899f5;
        border: 1px solid #2899f5;
        border-radius: 4px;
        color: black;
        text-decoration: none;
        cursor: pointer;
        transition: background-color 0.2s ease, border-color 0.2s ease,
          box-shadow 0.2s ease, color 0.2s ease;
      }
      .fluent-button:hover {
        background-color: #56b1f7;
        border-color: #56b1f7;
        color: black;
        text-decoration: none;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.4);
      }
      .fluent-button:active {
        background-color: #1a8ad8;
        border-color: #1a8ad8;
        color: black;
        box-shadow: none;
      }

      .resize-handle {
        position: absolute;
        bottom: 0;
        right: 0;
        width: 15px;
        height: 15px;
        background: repeating-linear-gradient(
          -45deg,
          rgba(255, 255, 255, 0.2),
          rgba(255, 255, 255, 0.2) 2px,
          transparent 2px,
          transparent 4px
        );
        cursor: nwse-resize;
        border-top: 1px solid rgba(255, 255, 255, 0.2);
        border-left: 1px solid rgba(255, 255, 255, 0.2);
        z-index: 10;
        touch-action: none;
      }

      #reopenAboutMeBtn {
        position: fixed;
        bottom: 20px;
        left: 20px;
        padding: 8px 15px;
        background-color: rgba(50, 50, 50, 0.7);
        color: #fff;
        border: 1px solid rgba(255, 255, 255, 0.15);
        border-radius: 4px;
        cursor: pointer;
        z-index: 1000;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.4);
        font-size: 14px;
      }

      #copyright-info {
        position: fixed;
        bottom: 5px;
        right: 10px;
        font-size: 10px;
        color: #cccccc;
        background-color: rgba(0, 0, 0, 0.7);
        padding: 2px 6px;
        border-radius: 3px;
        z-index: 0;
        text-shadow: none;
        max-width: 40%;
        text-align: right;
        pointer-events: none;
      }

      .projects-list ul {
        list-style: none;
        padding: 0;
        margin: 0;
      }
      .projects-list li {
        margin-bottom: 25px;
        padding-bottom: 15px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }
      .projects-list li:last-child {
        margin-bottom: 0;
        padding-bottom: 0;
        border-bottom: none;
      }
      .project-title {
        margin-top: 0;
        margin-bottom: 5px;
        font-size: 18px;
        font-weight: 600;
      }
      .project-title a {
        color: #2899f5;
        text-decoration: none;
      }
      .project-title a:hover {
        color: #56b1f7;
        text-decoration: underline;
      }
      .project-visibility {
        font-size: 0.75em;
        font-weight: normal;
        color: #cccccc;
        border: 1px solid rgba(255, 255, 255, 0.15);
        border-radius: 3px;
        padding: 1px 4px;
        margin-left: 8px;
        vertical-align: middle;
      }
      .project-desc {
        font-size: 14px;
        margin-top: 0;
        margin-bottom: 10px;
        color: #cccccc;
      }
      .project-tags span {
        display: inline-block;
        background-color: rgba(255, 255, 255, 0.08);
        color: #2899f5;
        padding: 2px 6px;
        border-radius: 4px;
        font-size: 12px;
        margin-right: 5px;
        margin-bottom: 5px;
      }
      .project-meta {
        font-size: 13px;
        color: #cccccc;
        margin-top: 10px;
      }
      .project-meta span {
        margin-right: 15px;
        display: inline-flex;
        align-items: center;
      }
      .project-lang::before {
        content: "•";
        margin-right: 5px;
        font-size: 1.2em;
        line-height: 1;
      }
      .project-lang.csharp::before {
        color: #d8a0df;
      }
      .project-lang.cpp::before,
      .project-lang.c::before {
        color: #cccccc;
      }
      .project-lang.java::before {
        color: #f1e05a;
      }
      .project-lang.lua::before {
        color: #7e80d4;
      }
      .project-lang.other::before {
        color: #aaaaaa;
      }
      .project-lang.na::before {
        display: none;
      }
      .project-license::before {
        content: "⚖️";
        margin-right: 5px;
        font-size: 0.9em;
      }
      .project-issues::before {
        content: "⚠️";
        margin-right: 5px;
        font-size: 0.9em;
      }

      .loading-message,
      .error-message {
        padding: 20px;
        text-align: center;
        color: #cccccc;
      }

      .profile-header {
        position: relative;
        width: 100px;
        margin: 0 auto 5px auto;
        height: 100px;
      }
      .profile-pic {
        margin: 0;
        position: absolute;
        top: 0;
        left: 0;
        border-color: var(--border-color, rgba(255, 255, 255, 0.15));
      }
      .custom-status-bubble {
        position: absolute;
        top: -15px;
        right: -120px;
        max-width: 160px;
        padding: 5px 10px;
        background-color: var(--card-bg, rgba(40, 40, 40, 0.9));
        backdrop-filter: blur(5px);
        -webkit-backdrop-filter: blur(5px);
        border: 1px solid var(--border-color, rgba(255, 255, 255, 0.15));
        border-radius: 15px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        font-size: 0.8em;
        color: var(--subtle-text, #cccccc);
        text-align: center;
        z-index: 5;
        word-wrap: break-word;
        opacity: 0;
        transition: opacity 0.3s ease-in-out;
      }
      .custom-status-bubble::after {
        content: "";
        position: absolute;
        bottom: -6px;
        left: 15px;
        border-width: 6px 6px 0 6px;
        border-style: solid;
        border-color: var(--border-color, rgba(255, 255, 255, 0.15)) transparent
          transparent transparent;
      }
      .custom-status-bubble::before {
        content: "";
        position: absolute;
        bottom: -5px;
        left: 16px;
        border-width: 5px 5px 0 5px;
        border-style: solid;
        border-color: var(--card-bg, rgba(40, 40, 40, 0.9)) transparent
          transparent transparent;
        z-index: 1;
      }
      .custom-status-bubble.visible {
        opacity: 1;
      }

      #discord-status-container h2 {
        margin-bottom: 5px;
        margin-top: 15px;
        border-bottom: none;
        font-size: 18px;
        color: var(--heading-color, #ffffff);
      }
      #discord-status-area {
        font-size: 0.9em;
        color: var(--body-text, #f0f0f0);
        margin-top: 0;
        margin-bottom: 20px;
        padding: 0;
        background-color: transparent;
        border: none;
        min-height: 1.5em;
      }
      .activity-item {
        display: flex;
        align-items: center;
        margin-bottom: 8px;
        min-height: 40px;
      }
      .activity-item:last-child {
        margin-bottom: 0;
      }
      .activity-icon {
        width: 40px;
        height: 40px;
        border-radius: 6px;
        margin-right: 10px;
        flex-shrink: 0;
        object-fit: cover;
        background-color: rgba(255, 255, 255, 0.05);
      }
      .activity-icon.spotify-art {
        border-radius: 4px;
      }
      .activity-text {
        flex-grow: 1;
        line-height: 1.4;
      }
      .activity-text strong {
        font-weight: 600;
        color: var(--heading-color, #ffffff);
      }

      .status-container {
        margin-bottom: 10px;
      }

      .status-online,
      .status-idle,
      .status-dnd,
      .status-offline {
        display: inline-block;
        font-weight: 600;
        padding: 2px 6px;
        border-radius: 4px;
        font-size: 0.9em;
      }

      .status-online {
        color: #ffffff;
        background-color: #3ba55c;
      }
      .status-offline {
        color: #b9bbbe;
        background-color: #747f8d;
        font-style: italic;
      }
      .status-idle {
        color: #ffffff;
        background-color: #faa61a;
        font-style: italic;
      }
      .status-dnd {
        color: #ffffff;
        background-color: #ed4245;
      }

      #discord-status-area .loading-message,
      #discord-status-area .error-message {
        padding: 0;
        text-align: left;
        font-style: italic;
        width: 100%;
        color: var(--subtle-text, #cccccc);
      }

      .vehicle-image {
        float: right;
        max-width: 150px;
        height: auto;
        margin: 0 0 10px 15px;
        border-radius: 4px;
        border: 1px solid var(--border-color, rgba(255, 255, 255, 0.15));
      }

      @media (prefers-color-scheme: light) {
        body {
          color: #201f1e;
          background-color: #fff;
        }
        .fluent-card {
          background: rgba(255, 255, 255, 0.9);
          border-color: rgba(0, 0, 0, 0.1);
          box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
        }
        .drag-handle {
          background-color: rgba(0, 0, 0, 0.05);
          border-bottom-color: rgba(0, 0, 0, 0.1);
        }
        .drag-handle img.handle-pic {
          border-color: rgba(0, 0, 0, 0.1);
        }
        .drag-handle h1.handle-title {
          color: #1a1a1a;
        }
        .window-button {
          color: #201f1e;
        }
        .window-button:not(:disabled):hover {
          background-color: rgba(0, 0, 0, 0.1);
        }
        .fluent-card-content {
          color: #201f1e;
        }
        .profile-pic {
          border-color: rgba(0, 0, 0, 0.1);
        }
        .fluent-card-content h1 {
          color: #1a1a1a;
        }
        .intro-text {
          color: #333;
        }
        .fluent-card-content h2 {
          color: #1a1a1a;
          border-bottom-color: rgba(0, 0, 0, 0.1);
        }
        .fluent-card-content li {
          color: #333;
        }
        .fluent-card-content li::before {
          color: #0078d4;
        }
        .tech-details {
          color: #555;
        }
        .scrolling-icons-track img {
          filter: none;
        }
        .links-section {
          border-top-color: rgba(0, 0, 0, 0.08);
          background-color: rgba(0, 0, 0, 0.05);
        }
        .fluent-button {
          background-color: #0078d4;
          border-color: #0078d4;
          color: white;
        }
        .fluent-button:hover {
          background-color: #005a9e;
          border-color: #005a9e;
          color: white;
          box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);
        }
        .fluent-button:active {
          background-color: #004c87;
          border-color: #004c87;
          color: white;
        }
        .resize-handle {
          background: repeating-linear-gradient(
            -45deg,
            rgba(0, 0, 0, 0.1),
            rgba(0, 0, 0, 0.1) 2px,
            transparent 2px,
            transparent 4px
          );
          border-top-color: rgba(0, 0, 0, 0.1);
          border-left-color: rgba(0, 0, 0, 0.1);
        }
        #reopenAboutMeBtn {
          background-color: rgba(255, 255, 255, 0.7);
          color: #000;
          border-color: rgba(0, 0, 0, 0.1);
          box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);
        }
        #copyright-info {
          color: #ffffff;
          background-color: rgba(0, 0, 0, 0.5);
          text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);
        }
        .projects-list li {
          border-bottom-color: rgba(0, 0, 0, 0.08);
        }
        .project-title a {
          color: #0078d4;
        }
        .project-title a:hover {
          color: #005a9e;
        }
        .project-visibility {
          color: #333;
          border-color: rgba(0, 0, 0, 0.1);
        }
        .project-desc {
          color: #333;
        }
        .project-tags span {
          background-color: rgba(0, 0, 0, 0.05);
          color: #0078d4;
        }
        .project-meta {
          color: #333;
        }
        .project-lang.csharp::before {
          color: #9b4f96;
        }
        .project-lang.cpp::before,
        .project-lang.c::before {
          color: #555555;
        }
        .project-lang.java::before {
          color: #b07219;
        }
        .project-lang.lua::before {
          color: #2c2d72;
        }
        .project-lang.other::before {
          color: #888888;
        }
        .loading-message,
        .error-message {
          color: #333;
        }
        #discord-status-area .loading-message,
        #discord-status-area .error-message {
          color: var(--subtle-text, #555);
        }
        .custom-status-bubble {
          background-color: var(--card-bg, rgba(255, 255, 255, 0.9));
          color: var(--subtle-text, #333);
        }
        .custom-status-bubble::before {
          border-top-color: var(--card-bg, rgba(255, 255, 255, 0.9));
        }
        .custom-status-bubble::after {
          border-top-color: var(--border-color, rgba(0, 0, 0, 0.1));
        }
        #discord-status-container h2 {
          color: var(--heading-color, #1a1a1a);
        }
        #discord-status-area {
          color: var(--body-text, #201f1e);
        }
        .activity-icon {
          background-color: rgba(0, 0, 0, 0.05);
        }
        .activity-text strong {
          color: var(--heading-color, #1a1a1a);
        }
        .status-online {
          color: #ffffff;
          background-color: #2d9d4c;
        }
        .status-offline {
          color: #ffffff;
          background-color: #747f8d;
        }
        .status-idle {
          color: #000000;
          background-color: #e69900;
        }
        .status-dnd {
          color: #ffffff;
          background-color: #d83c3e;
        }
      }

      @supports (--foo: bar) and
        ((backdrop-filter: blur(10px)) or (-webkit-backdrop-filter: blur(10px))) {
        :root {
          --scroll-duration: 70s;
          --min-card-width: 320px;
          --min-card-height: 400px;
          --body-bg: #1c1c1c;
          --body-text: #f0f0f0;
          --heading-color: #ffffff;
          --subtle-text: #cccccc;
          --link-color: #2899f5;
          --link-hover: #56b1f7;
          --border-color: rgba(255, 255, 255, 0.15);
          --card-bg: rgba(40, 40, 40, 0.85);
          --card-shadow: rgba(0, 0, 0, 0.4);
          --handle-bg: rgba(255, 255, 255, 0.08);
          --section-separator: rgba(255, 255, 255, 0.1);
          --button-bg: #2899f5;
          --button-text: black;
          --button-hover-bg: #56b1f7;
          --button-active-bg: #1a8ad8;
          --window-button-text: var(--body-text);
          --window-button-hover-bg: rgba(255, 255, 255, 0.15);
          --window-button-close-hover-bg: #e81123;
          --window-button-close-hover-text: white;
          --resize-handle-border: rgba(255, 255, 255, 0.2);
          --resize-handle-fill: rgba(255, 255, 255, 0.2);
          --reopen-button-bg: rgba(50, 50, 50, 0.7);
          --reopen-button-text: #fff;
          --reopen-button-shadow: var(--card-shadow);
          --copyright-bg: rgba(0, 0, 0, 0.7);
          --copyright-text: #cccccc;
          --project-lang-csharp: #d8a0df;
          --project-lang-cpp: #cccccc;
          --project-lang-java: #f1e05a;
          --project-lang-lua: #7e80d4;
          --project-lang-other: #aaaaaa;
          --bg-image-landscape: none;
          --bg-image-portrait: none;
        }
        @media (prefers-color-scheme: light) {
          :root {
            --body-bg: #fff;
            --body-text: #201f1e;
            --heading-color: #1a1a1a;
            --subtle-text: #333;
            --link-color: #0078d4;
            --link-hover: #005a9e;
            --border-color: rgba(0, 0, 0, 0.1);
            --card-bg: rgba(255, 255, 255, 0.85);
            --card-shadow: rgba(0, 0, 0, 0.15);
            --handle-bg: rgba(0, 0, 0, 0.05);
            --section-separator: rgba(0, 0, 0, 0.08);
            --button-bg: #0078d4;
            --button-text: white;
            --button-hover-bg: #005a9e;
            --button-active-bg: #004c87;
            --resize-handle-border: rgba(0, 0, 0, 0.1);
            --resize-handle-fill: rgba(0, 0, 0, 0.1);
            --reopen-button-bg: rgba(255, 255, 255, 0.7);
            --reopen-button-text: #000;
            --reopen-button-shadow: var(--card-shadow);
            --copyright-bg: rgba(0, 0, 0, 0.5);
            --copyright-text: #ffffff;
            --project-lang-csharp: #9b4f96;
            --project-lang-cpp: #555555;
            --project-lang-java: #b07219;
            --project-lang-lua: #2c2d72;
            --project-lang-other: #888888;
          }
        }
        html {
          color-scheme: dark light;
        }
        body {
          background: var(--bg-image-landscape) no-repeat center center fixed;
          background-size: cover;
          color: var(--body-text);
          background-color: var(--body-bg);
        }
        @media (orientation: portrait) {
          body {
            background-image: var(--bg-image-portrait);
          }
        }
        .fluent-card {
          background: var(--card-bg);
          backdrop-filter: blur(15px);
          -webkit-backdrop-filter: blur(15px);
          border-color: var(--border-color);
          box-shadow: 0 8px 30px var(--card-shadow);
        }
        .drag-handle {
          background-color: var(--handle-bg);
          border-bottom-color: var(--border-color);
        }
        .drag-handle img.handle-pic {
          border-color: var(--border-color);
        }
        .drag-handle h1.handle-title {
          color: var(--heading-color);
        }
        .window-button {
          color: var(--window-button-text);
        }
        .window-button:not(:disabled):hover {
          background-color: var(--window-button-hover-bg);
        }
        .window-button.close:not(:disabled):hover {
          background-color: var(--window-button-close-hover-bg);
          color: var(--window-button-close-hover-text);
        }
        .fluent-card-content {
          color: var(--body-text);
        }
        .profile-pic {
          border-color: var(--border-color);
        }
        .fluent-card-content h1 {
          color: var(--heading-color);
        }
        .intro-text {
          color: var(--subtle-text);
        }
        .fluent-card-content h2 {
          color: var(--heading-color);
          border-bottom-color: var(--border-color);
        }
        .fluent-card-content li {
          color: var(--subtle-text);
        }
        .fluent-card-content li::before {
          color: var(--link-color);
        }
        .tech-details {
          color: var(--subtle-text);
        }
        .scrolling-icons-track {
          animation-duration: var(--scroll-duration);
        }
        .scrolling-icons-track img {
          filter: brightness(0.9);
        }
        @media (prefers-color-scheme: light) {
          .scrolling-icons-track img {
            filter: none;
          }
        }
        .links-section {
          border-top-color: var(--section-separator);
          background-color: var(--handle-bg);
        }
        .fluent-button {
          background-color: var(--button-bg);
          border-color: var(--button-bg);
          color: var(--button-text);
        }
        .fluent-button:hover {
          background-color: var(--button-hover-bg);
          border-color: var(--button-hover-bg);
          color: var(--button-text);
          box-shadow: 0 2px 5px var(--card-shadow);
        }
        .fluent-button:active {
          background-color: var(--button-active-bg);
          border-color: var(--button-active-bg);
          color: var(--button-text);
        }
        .resize-handle {
          background: repeating-linear-gradient(
            -45deg,
            var(--resize-handle-fill),
            var(--resize-handle-fill) 2px,
            transparent 2px,
            transparent 4px
          );
          border-top-color: var(--resize-handle-border);
          border-left-color: var(--resize-handle-border);
        }
        #reopenAboutMeBtn {
          background-color: var(--reopen-button-bg);
          color: var(--reopen-button-text);
          border-color: var(--border-color);
          box-shadow: 0 2px 5px var(--reopen-button-shadow);
        }
        #copyright-info {
          color: var(--copyright-text);
          background-color: var(--copyright-bg);
          text-shadow: none;
        }
        .projects-list li {
          border-bottom-color: var(--section-separator);
        }
        .project-title a {
          color: var(--link-color);
        }
        .project-title a:hover {
          color: var(--link-hover);
        }
        .project-visibility {
          color: var(--subtle-text);
          border-color: var(--border-color);
        }
        .project-desc {
          color: var(--subtle-text);
        }
        .project-tags span {
          background-color: var(--handle-bg);
          color: var(--link-color);
        }
        .project-meta {
          color: var(--subtle-text);
        }
        .project-lang.csharp::before {
          color: var(--project-lang-csharp);
        }
        .project-lang.cpp::before,
        .project-lang.c::before {
          color: var(--project-lang-cpp);
        }
        .project-lang.java::before {
          color: var(--project-lang-java);
        }
        .project-lang.lua::before {
          color: var(--project-lang-lua);
        }
        .project-lang.other::before {
          color: var(--project-lang-other);
        }
        .loading-message,
        .error-message {
          color: var(--subtle-text);
        }
        #discord-status-container h2 {
          color: var(--heading-color);
        }
        #discord-status-area {
          color: var(--body-text);
        }
        #discord-status-area .loading-message,
        #discord-status-area .error-message {
          color: var(--subtle-text);
        }
        .custom-status-bubble {
          background-color: var(--card-bg);
          color: var(--subtle-text);
          border-color: var(--border-color);
        }
        .custom-status-bubble::after {
          border-top-color: var(--border-color);
        }
        .custom-status-bubble::before {
          border-top-color: var(--card-bg);
        }
        .activity-text strong {
          color: var(--heading-color);
        }
      }
    </style>
  </head>
  <body>
    <button id="reopenAboutMeBtn">About Me</button>
    <div id="copyright-info"></div>

    <script>
      var GITHUB_USERNAME = "megabytesme";
      var DISCORD_USER_ID = "374261881143296000";
      var LANYARD_RECONNECT_DELAY = 5000;
      var LANYARD_MAX_WS_RETRIES = 3;
      var LANYARD_POLL_INTERVAL_MS = 20000;
      var LANYARD_MAX_POLL_FAILURES = 5;
      var MIN_WINDOW_WIDTH = 320;
      var MIN_WINDOW_HEIGHT = 400;
      var SPOTLIGHT_API_HOST_PATH = "megabytesme.ddns.net/api/spotlight-data";
      var SPOTLIGHT_IMAGE_HOST_PATH = "megabytesme.ddns.net/cached-images/";
      var LANYARD_API_PROXY_HOST_PATH =
        "megabytesme.ddns.net/lanyard-api/v1/users/";
      var LANYARD_WS_PROXY_HOST_PATH = "megabytesme.ddns.net/lanyard-ws/";

      var FALLBACK_LANDSCAPE_IMG =
        "https://windows10spotlight.com/wp-content/uploads/2025/03/862c9b0ab32209d19a329e88d67af1e9.jpg";
      var FALLBACK_PORTRAIT_IMG =
        "https://windows10spotlight.com/wp-content/uploads/2025/03/996ac5d452384af9ed57976915617a0d.jpg";
      var DEFAULT_WINDOW_ICON = "https://via.placeholder.com/20";
      var GITHUB_ICON_URL =
        "https://git-scm.com/images/logos/downloads/Git-Icon-White.svg";
      var PC_RIGS_ICON_URL =
        "https://img.icons8.com/fluency/48/workstation.png";
      var VEHICLES_ICON_URL = "https://img.icons8.com/fluency/48/car.png";
      var PROFILE_PIC_URL =
        "https://avatars.githubusercontent.com/u/57240557?v=4";

      var pageProtocol = window.location.protocol;
      var SPOTLIGHT_API_URL = pageProtocol + "//" + SPOTLIGHT_API_HOST_PATH;
      var SPOTLIGHT_IMAGE_BASE =
        pageProtocol + "//" + SPOTLIGHT_IMAGE_HOST_PATH;

      var LANYARD_API_PROXY_BASE =
        pageProtocol + "//" + LANYARD_API_PROXY_HOST_PATH;

      var lanyardWsProxyProtocol = pageProtocol === "https:" ? "wss:" : "ws:";
      var LANYARD_WS_PROXY_URL =
        lanyardWsProxyProtocol + "//" + LANYARD_WS_PROXY_HOST_PATH;

      var windows = {};
      var highestZ = 1;
      var activeInteractionWindow = null;
      var lanyardSocket = null;
      var lanyardHeartbeatInterval = null;
      var lanyardReconnectTimeout = null;
      var lanyardWSRetryCount = 0;
      var lanyardPollIntervalId = null;
      var lanyardPollFailureCount = 0;
      var lanyardUpdateMethod = null;

      var aboutMeContent =
        '<div class="content-area">' +
        '<div class="profile-header">' +
        '<img src="' +
        PROFILE_PIC_URL +
        '" alt="Profile Picture" class="profile-pic">' +
        '<div id="custom-status-bubble" class="custom-status-bubble" style="display: none;"></div>' +
        "</div>" +
        "<h1>MegaBytesMe (Ben)</h1>" +
        '<div id="discord-status-container">' +
        "<h2>Current Activity</h2>" +
        '<div id="discord-status-area">' +
        '<p class="loading-message">Loading Discord status...</p>' +
        "</div>" +
        "</div>" +
        '<p class="intro-text">Hey! 👋🏻<br>I\'m Ben, a student and developer with a passion for trying out new areas of software development, from utilities, webapps and modding games to university projects and desktop applications.</p>' +
        '<p class="intro-text">I have a keen interest on unique platforms (ranging from Windows 10 Mobile to the Nintendo Wii U) - They hold a special place to me for some reason 😂. Beyond software development, I also have an interest in electronics, cars and DIY.</p>' +
        "<h2>Technologies & Languages</h2><p>I primarily work with:</p>" +
        "<ul><li>C#</li><li>C++</li><li>Java</li><li>Lua</li><li>TypeScript</li></ul>" +
        '<p class="tech-details">I have also tinkered with technologies and concepts such as .NET, React, CMake, Docker, JBeam (BeamNG.drive\'s vehicle description language), and various game modding APIs including Fabric (Minecraft) alongside working with RGB SDKs (Primarily iCue). I also have worked with cloud services - Beyond AWS, I also have my own cloud instance too which I run containers on.</p>' +
        "<h2>Technologies I have worked with:</h2>" +
        '<div class="scrolling-icons-container"><div class="scrolling-icons-track">' +
        '<img src="https://edent.github.io/SuperTinyIcons/images/svg/visualstudiocode.svg" alt="Visual Studio Code logo"><img src="https://tech-stack-icons.com/assets/light/csharp.svg" alt="C# logo"><img src="https://tech-stack-icons.com/assets/light/c++.svg" alt="C++ logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/java.svg" alt="Java logo"><img src="https://tech-stack-icons.com/assets/light/lua.svg" alt="Lua logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/typescript.svg" alt="TypeScript logo"><img src="https://tech-stack-icons.com/assets/light/python.svg" alt="Python logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/react.svg" alt="React logo"><img src="https://tech-stack-icons.com/assets/light/html5.svg" alt="HTML5 logo"><img src="https://tech-stack-icons.com/assets/light/css3.svg" alt="CSS3 logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/microsoft.svg" alt="Microsoft logo"><img src="https://tech-stack-icons.com/assets/light/git.svg" alt="Git logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/gitlab.svg" alt="GitLab logo"><img src="https://tech-stack-icons.com/assets/light/github.svg" alt="GitHub logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/docker.svg" alt="Docker logo"><img src="https://tech-stack-icons.com/assets/light/aws.svg" alt="AWS logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/azure.svg" alt="Microsoft Azure logo"><img src="https://tech-stack-icons.com/assets/light/postgresql.svg" alt="PostgreSQL logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/terraform.svg" alt="Terraform logo"><img src="https://tech-stack-icons.com/assets/light/npm.svg" alt="NPM logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/slack.svg" alt="Slack logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/zoom.svg" alt="Zoom logo"><img src="https://tech-stack-icons.com/assets/light/onedrive.svg" alt="OneDrive logo">' +
        '<img src="https://edent.github.io/SuperTinyIcons/images/svg/visualstudiocode.svg" alt="Visual Studio Code logo"><img src="https://tech-stack-icons.com/assets/light/csharp.svg" alt="C# logo"><img src="https://tech-stack-icons.com/assets/light/c++.svg" alt="C++ logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/java.svg" alt="Java logo"><img src="https://tech-stack-icons.com/assets/light/lua.svg" alt="Lua logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/typescript.svg" alt="TypeScript logo"><img src="https://tech-stack-icons.com/assets/light/python.svg" alt="Python logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/react.svg" alt="React logo"><img src="https://tech-stack-icons.com/assets/light/html5.svg" alt="HTML5 logo"><img src="https://tech-stack-icons.com/assets/light/css3.svg" alt="CSS3 logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/microsoft.svg" alt="Microsoft logo"><img src="https://tech-stack-icons.com/assets/light/git.svg" alt="Git logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/gitlab.svg" alt="GitLab logo"><img src="https://tech-stack-icons.com/assets/light/github.svg" alt="GitHub logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/docker.svg" alt="Docker logo"><img src="https://tech-stack-icons.com/assets/light/aws.svg" alt="AWS logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/azure.svg" alt="Microsoft Azure logo"><img src="https://tech-stack-icons.com/assets/light/postgresql.svg" alt="PostgreSQL logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/terraform.svg" alt="Terraform logo"><img src="https://tech-stack-icons.com/assets/light/npm.svg" alt="NPM logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/slack.svg" alt="Slack logo"><img src="https://edent.github.io/SuperTinyIcons/images/svg/zoom.svg" alt="Zoom logo"><img src="https://tech-stack-icons.com/assets/light/onedrive.svg" alt="OneDrive logo">' +
        "</div></div>" +
        "</div>";
      var aboutMeFooter =
        '<button class="fluent-button view-projects-button">View Projects</button>' +
        '<button class="fluent-button view-rigs-button">View PC Rigs</button>' +
        '<button class="fluent-button view-vehicles-button">View Vehicles</button>';
      var projectsInitialContent =
        '<div class="projects-list"><p class="loading-message">Loading GitHub projects...</p></div>';
      var projectsFooter =
        '<button class="fluent-button close-window-button">Close GitHub Projects</button>' +
        '<a href="https://github.com/' +
        GITHUB_USERNAME +
        '" target="_blank" rel="noopener noreferrer" class="fluent-button">GitHub</a>';
      var pcRigsContent =
        '<div class="content-area">' +
        "<h1>My PC Rigs</h1>" +
        "<h2>Main Desktop (2025)</h2>" +
        "<ul><li>CPU: AMD Ryzen 9 5950X</li><li>GPU: NVIDIA GeForce RTX 3090 Ti</li><li>RAM: 32GB DDR4-3600Mhz</li><li>Storage: 256GB NVMe SSD + 2x2TB HDD</li><li>OS: Windows 11 Pro</li></ul>" +
        '<p class="intro-text">My primary workstation for development, gaming, and everything in between.</p>' +
        '<h2>Surface Book 3 15" Laptop</h2>' +
        "<ul><li>CPU: Intel i7 1065G7</li><li>GPU: NVIDIA Quadro RTX 3000 Mobile</li><li>RAM: 32GB DDR4 3200Mhz</li><li>Storage: 512GB NVMe SSD</li><li>OS: Windows 11 Pro</li></ul>" +
        '<p class="intro-text">Portable power for gaming and development on the go.</p>' +
        '<h2>Surface Pro X SQ1 LTE" Tablet</h2>' +
        "<ul><li>CPU: Microsoft SQ1</li><li>GPU: Qualcomn Adreno 685</li><li>RAM: 8GB DDR4 1866Mhz</li><li>Storage: 1TB NVMe SSD</li><li>OS: Windows 11 Pro</li></ul>" +
        '<p class="intro-text">Lightweight & low-power for light development and media on the go.</p>' +
        "</div>";
      var pcRigsFooter =
        '<button class="fluent-button close-window-button">Close Rigs</button>';
      var vehiclesContent =
        '<div class="content-area">' +
        "<h1>My Vehicles</h1>" +
        "<h2>Alfa Romeo 159 (Saloon)</h2>" +
        '<img src="assets/images/alfaromeo159.jpg" alt="Red Alfa Romeo 159" class="vehicle-image">' +
        "<ul><li>Engine: 2.4L JTDm (240HP, 480NM)</li><li>Transmission: 6-Speed Manual</li><li>Color: Russo Red</li></ul>" +
        '<p class="intro-text">My first (and current) car. Handles like a train (despite the weight)!</p>' +
        "<h2>Chrysler Grand Voyager</h2>" +
        '<img src="assets/images/chryslergrandvoyager.jpg" alt="Dark Blue Chrysler Grand Voyager" class="vehicle-image">' +
        "<ul><li>Engine: 2.8L CRD</li><li>Transmission: 6-Speed Automatic</li><li>Color: Dark Blue</li></ul>" +
        '<p class="intro-text">The daily driver when I am fixing the suspension of the Alfa. Cruiser.</p>' +
        "<h2>MN MODEL MN128 (RC - Toy)</h2>" +
        '<img src="assets/images/mnmodelmn128.jpg" alt="Silver MN Model MN128 Remote Control Car" class="vehicle-image">' +
        "<ul><li>Motor: 540 (21T)</li><li>Transmission: 4WD Single-Speed</li><li>Color: Silver</li></ul>" +
        '<p class="intro-text">My Remote-Controlled (RC) car. Modified with upgraded motor and bigger battery (2s LiPo).</p>' +
        "</div>";
      var vehiclesFooter =
        '<button class="fluent-button close-window-button">Close Vehicles</button>';

      function FluentWindow(id, title, titleIconUrl, contentHtml, options) {
        options = options || {};
        this.id = id;
        this.isDragging = false;
        this.isResizing = false;
        this.positionedWithTopLeft = false;
        this.dragOffsetX = 0;
        this.dragOffsetY = 0;
        this.resizeInitialMouseX = 0;
        this.resizeInitialMouseY = 0;
        this.initialWidth = 0;
        this.initialHeight = 0;
        this.initialCardX_resize = 0;
        this.initialCardY_resize = 0;
        this.element = this._createWindowElement(
          id,
          title,
          titleIconUrl,
          options.footerHtml
        );
        this.contentContainer = this.element.querySelector(
          ".fluent-card-content"
        );
        this.dragHandle = this.element.querySelector(".drag-handle");
        this.resizeHandle = this.element.querySelector(".resize-handle");
        this.closeButton = this.element.querySelector(".window-button.close");
        this.setContent(contentHtml);
        this._attachEventListeners();
        this._setInitialPosition(options.initialOffset);
        this.bringToFront();
      }
      FluentWindow.prototype.setContent = function (html) {
        try {
          if (this.contentContainer) {
            this.contentContainer.innerHTML = html;
          }
        } catch (e) {
          console.error("Error setting window content:", e);
        }
      };
      FluentWindow.prototype._createWindowElement = function (
        id,
        title,
        titleIconUrl,
        footerHtml
      ) {
        var card = document.createElement("div");
        card.className = "fluent-card";
        card.id = "window-" + id;
        var footerSection = footerHtml
          ? '<div class="links-section">' + footerHtml + "</div>"
          : "";
        card.innerHTML =
          '<div class="drag-handle">' +
          '<img src="' +
          (titleIconUrl || DEFAULT_WINDOW_ICON) +
          '" alt="Window Icon" class="handle-pic">' +
          '<h1 class="handle-title">' +
          title +
          "</h1>" +
          '<div class="window-controls">' +
          '<button class="window-button minimize" disabled aria-hidden="true">–</button>' +
          '<button class="window-button maximize" disabled aria-hidden="true">▢</button>' +
          '<button class="window-button close" aria-label="Close ' +
          title +
          '">✕</button>' +
          "</div>" +
          "</div>" +
          '<div class="fluent-card-content"></div>' +
          footerSection +
          '<div class="resize-handle"></div>';
        document.body.appendChild(card);
        return card;
      };
      FluentWindow.prototype._setInitialPosition = function (offset) {
        var self = this;
        offset = offset || { x: 0, y: 0 };
        var reqAnimFrame =
          window.requestAnimationFrame ||
          window.mozRequestAnimationFrame ||
          window.webkitRequestAnimationFrame ||
          window.msRequestAnimationFrame ||
          function (callback) {
            window.setTimeout(callback, 1000 / 60);
          };
        reqAnimFrame(function () {
          try {
            if (!self.element) return;
            if (self.element.style.left || self.element.style.top) {
              return;
            }
            var cardWidth = self.element.offsetWidth;
            var cardHeight = self.element.offsetHeight;
            var viewportWidth = document.documentElement.clientWidth;
            var viewportHeight = document.documentElement.clientHeight;
            if (cardWidth <= 0 || cardHeight <= 0) {
              console.warn(
                "Window " +
                  self.id +
                  " has invalid dimensions (" +
                  cardWidth +
                  "x" +
                  cardHeight +
                  "), retrying positioning."
              );
              setTimeout(function () {
                self._setInitialPosition(offset);
              }, 50);
              return;
            }
            var initialLeft =
              viewportWidth > cardWidth ? (viewportWidth - cardWidth) / 2 : 0;
            var initialTop =
              viewportHeight > cardHeight
                ? (viewportHeight - cardHeight) / 2
                : 0;
            initialLeft += offset.x;
            initialTop += offset.y;
            initialLeft = Math.max(0, initialLeft);
            initialTop = Math.max(0, initialTop);
            if (initialLeft + cardWidth > viewportWidth) {
              initialLeft = Math.max(0, viewportWidth - cardWidth);
            }
            if (initialTop + cardHeight > viewportHeight) {
              initialTop = Math.max(0, viewportHeight - cardHeight);
            }
            self.element.style.left = initialLeft + "px";
            self.element.style.top = initialTop + "px";
            self.positionedWithTopLeft = true;
            _updateContentHeight(self);
          } catch (e) {
            console.error("Error setting initial position:", e);
          }
        });
      };
      function _updateContentHeight(windowInstance) {
        try {
          if (!windowInstance || !windowInstance.element) return;
          var card = windowInstance.element;
          var handle = windowInstance.dragHandle;
          var footer = card.querySelector(".links-section");
          var content = windowInstance.contentContainer;

          if (!handle || !content) return;

          var cardHeight = card.offsetHeight;
          var handleHeight = handle.offsetHeight;
          var footerHeight = footer ? footer.offsetHeight : 0;
          var contentHeight = cardHeight - handleHeight - footerHeight;

          if (contentHeight > 0) {
            content.style.height = contentHeight + "px";
          } else {
            content.style.height = "100px";
          }
        } catch (e) {
          console.error("Error updating content height", e);
        }
      }
      FluentWindow.prototype._attachEventListeners = function () {
        try {
          var supportsTouch =
            "ontouchstart" in window ||
            (window.navigator && window.navigator.msMaxTouchPoints > 0);
          var down = supportsTouch ? "touchstart" : "mousedown";
          var up = supportsTouch ? "touchend" : "mouseup";
          var move = supportsTouch ? "touchmove" : "mousemove";

          this._boundStartDrag = this._startDrag.bind(this);
          this._boundStartResize = this._startResize.bind(this);
          this._boundBringToFront = this.bringToFront.bind(this);
          this._boundDestroy = this.destroy.bind(this);

          addEvent(this.dragHandle, down, this._boundStartDrag);
          addEvent(this.resizeHandle, down, this._boundStartResize);
          addEvent(this.element, down, this._boundBringToFront);
          addEvent(this.closeButton, "click", this._boundDestroy);

          var footer = this.element.querySelector(".links-section");
          if (footer) {
            var self = this;
            this._boundFooterClick = function (e) {
              e = e || window.event;
              var target = e.target || window.event.srcElement;
              var targetClassName = target.className || "";
              var classNameStr = " " + targetClassName + " ";
              var stopProp = function (evt) {
                if (evt.stopPropagation) evt.stopPropagation();
                else if (window.event) window.event.cancelBubble = true;
              };

              if (classNameStr.indexOf(" view-projects-button ") > -1) {
                stopProp(e);
                createProjectsWindow();
              } else if (classNameStr.indexOf(" view-rigs-button ") > -1) {
                stopProp(e);
                createPcRigsWindow();
              } else if (classNameStr.indexOf(" view-vehicles-button ") > -1) {
                stopProp(e);
                createVehiclesWindow();
              } else if (classNameStr.indexOf(" close-window-button ") > -1) {
                stopProp(e);
                self.destroy();
              }
            };
            addEvent(footer, "click", this._boundFooterClick);
          } else {
            console.error(
              "ERROR: Footer element (.links-section) not found for window: " +
                this.id
            );
          }
        } catch (e) {
          console.error("Error attaching event listeners:", e);
        }
      };
      FluentWindow.prototype.bringToFront = function () {
        highestZ++;
        this.element.style.zIndex = highestZ;
      };
      FluentWindow.prototype._switchToTopLeftPositioningIfNeeded = function () {
        if (
          !this.positionedWithTopLeft &&
          !this.element.style.left &&
          !this.element.style.top
        ) {
          this._setInitialPosition();
        }
      };
      FluentWindow.prototype._startDrag = function (e) {
        try {
          e = e || window.event;
          var target = e.target || e.srcElement;
          var isTouchEvent = e.type.indexOf("touch") === 0;
          var currentEvent = isTouchEvent ? e.touches[0] : e;

          var findParent = function (el, sel) {
            while (el && el.parentNode && el.tagName !== "BODY") {
              el = el.parentNode;
              if (
                (" " + (el.className || "") + " ").indexOf(" " + sel + " ") > -1
              ) {
                return el;
              }
            }
            return null;
          };

          var controls = findParent(target, "window-controls");
          var handle = findParent(target, "drag-handle");

          if (target.nodeName === "BUTTON" || controls) {
            return;
          }
          if (target !== this.dragHandle && !handle) {
            return;
          }
          if (this.isResizing) {
            return;
          }

          this._switchToTopLeftPositioningIfNeeded();
          this.bringToFront();
          this.isDragging = true;
          activeInteractionWindow = this;

          var rect = this.element.getBoundingClientRect();
          var startClientX = currentEvent.clientX;
          var startClientY = currentEvent.clientY;
          var currentLeft = parseFloat(this.element.style.left) || rect.left;
          var currentTop = parseFloat(this.element.style.top) || rect.top;
          this.dragOffsetX = startClientX - currentLeft;
          this.dragOffsetY = startClientY - currentTop;

          this._boundDoDrag = this._doDrag.bind(this);
          this._boundEndDrag = this._endDrag.bind(this);

          var moveEventName = isTouchEvent ? "touchmove" : "mousemove";
          var endEventName = isTouchEvent ? "touchend" : "mouseup";

          addEvent(document, moveEventName, this._boundDoDrag);
          addEvent(document, endEventName, this._boundEndDrag);

          this.dragHandle.style.cursor = "grabbing";
          document.body.style.cursor = "grabbing";

          if (!isTouchEvent && e.preventDefault) {
            e.preventDefault();
          } else if (!isTouchEvent) {
            e.returnValue = false;
          }
        } catch (err) {
          console.error("Error starting drag: " + (err.message || err));
          this.isDragging = false;
          activeInteractionWindow = null;
        }
      };
      FluentWindow.prototype._doDrag = function (e) {
        if (!this.isDragging) return;

        var isTouchEvent = e.type.indexOf("touch") === 0;
        if (isTouchEvent && (!e.touches || e.touches.length === 0)) {
          return;
        }
        var currentEvent = isTouchEvent ? e.touches[0] : e;

        var currentMouseX = currentEvent.clientX;
        var currentMouseY = currentEvent.clientY;

        try {
          var contentRect = this.contentContainer.getBoundingClientRect();
          if (
            currentMouseX >= contentRect.left &&
            currentMouseX <= contentRect.right &&
            currentMouseY >= contentRect.top &&
            currentMouseY <= contentRect.bottom
          ) {
            return;
          }
        } catch (contentRectErr) {
          console.error(
            "Error getting content rect in _doDrag: " +
              (contentRectErr.message || contentRectErr)
          );
        }

        if (e.preventDefault) e.preventDefault();
        else e.returnValue = false;

        var newCardX = currentMouseX - this.dragOffsetX;
        var newCardY = currentMouseY - this.dragOffsetY;
        var viewportWidth = document.documentElement.clientWidth;
        var viewportHeight = document.documentElement.clientHeight;
        var cardWidth = this.element.offsetWidth;
        var cardHeight = this.element.offsetHeight;
        newCardX = Math.max(0, Math.min(newCardX, viewportWidth - cardWidth));
        newCardY = Math.max(0, Math.min(newCardY, viewportHeight - cardHeight));
        this.element.style.left = newCardX + "px";
        this.element.style.top = newCardY + "px";
      };
      FluentWindow.prototype._endDrag = function (e) {
        if (!this.isDragging) return;

        var isTouchEvent = e.type.indexOf("touch") === 0;
        var moveEventName = isTouchEvent ? "touchmove" : "mousemove";
        var endEventName = isTouchEvent ? "touchend" : "mouseup";

        this.isDragging = false;

        this.dragHandle.style.cursor = "grab";
        if (activeInteractionWindow === this) {
          activeInteractionWindow = null;
          document.body.style.cursor = "default";
        }

        if (this._boundDoDrag)
          removeEvent(document, moveEventName, this._boundDoDrag);
        if (this._boundEndDrag)
          removeEvent(document, endEventName, this._boundEndDrag);

        this._boundDoDrag = null;
        this._boundEndDrag = null;
      };
      FluentWindow.prototype._startResize = function (e) {
        try {
          e = e || window.event;
          var target = e.target || e.srcElement;
          var isTouchEvent = e.type.indexOf("touch") === 0;
          var currentEvent = isTouchEvent ? e.touches[0] : e;

          if (target !== this.resizeHandle) {
            return;
          }
          if (this.isDragging) {
            return;
          }

          this._switchToTopLeftPositioningIfNeeded();
          this.bringToFront();
          this.isResizing = true;
          activeInteractionWindow = this;
          document.body.style.cursor = "nwse-resize";

          this.initialWidth = this.element.offsetWidth;
          this.initialHeight = this.element.offsetHeight;
          this.initialCardX_resize = this.element.offsetLeft;
          this.initialCardY_resize = this.element.offsetTop;

          this.resizeInitialMouseX = currentEvent.clientX;
          this.resizeInitialMouseY = currentEvent.clientY;

          this._boundDoResize = this._doResize.bind(this);
          this._boundEndResize = this._endResize.bind(this);

          var moveEventName = isTouchEvent ? "touchmove" : "mousemove";
          var endEventName = isTouchEvent ? "touchend" : "mouseup";

          addEvent(document, moveEventName, this._boundDoResize);
          addEvent(document, endEventName, this._boundEndResize);
        } catch (err) {
          console.error("Error starting resize: " + (err.message || err));
          this._endResize(e);
        }
      };
      FluentWindow.prototype._doResize = function (e) {
        if (!this.isResizing) return;
        e = e || window.event;

        var isTouchEvent = e.type.indexOf("touch") === 0;
        if (isTouchEvent && (!e.touches || e.touches.length === 0)) {
          return;
        }
        var currentEvent = isTouchEvent ? e.touches[0] : e;

        var currentMouseX = currentEvent.clientX;
        var currentMouseY = currentEvent.clientY;
        var dx = currentMouseX - this.resizeInitialMouseX;
        var dy = currentMouseY - this.resizeInitialMouseY;

        if (e.preventDefault) e.preventDefault();
        else e.returnValue = false;

        var newWidth = this.initialWidth + dx;
        var newHeight = this.initialHeight + dy;
        newWidth = Math.max(MIN_WINDOW_WIDTH, newWidth);
        newHeight = Math.max(MIN_WINDOW_HEIGHT, newHeight);
        var viewportWidth = document.documentElement.clientWidth;
        var viewportHeight = document.documentElement.clientHeight;
        if (this.initialCardX_resize + newWidth > viewportWidth) {
          newWidth = viewportWidth - this.initialCardX_resize;
        }
        if (this.initialCardY_resize + newHeight > viewportHeight) {
          newHeight = viewportHeight - this.initialCardY_resize;
        }
        newWidth = Math.max(MIN_WINDOW_WIDTH, newWidth);
        newHeight = Math.max(MIN_WINDOW_HEIGHT, newHeight);

        this.element.style.width = newWidth + "px";
        this.element.style.height = newHeight + "px";

        if (typeof _updateContentHeight === "function") {
          _updateContentHeight(this);
        }
      };
      FluentWindow.prototype._endResize = function (e) {
        if (!this.isResizing) return;

        e = e || window.event;
        var isTouchEvent = e.type.indexOf("touch") === 0;
        var moveEventName = isTouchEvent ? "touchmove" : "mousemove";
        var endEventName = isTouchEvent ? "touchend" : "mouseup";

        if (this.isResizing) {
          this.isResizing = false;
          if (activeInteractionWindow === this) {
            activeInteractionWindow = null;
            document.body.style.cursor = "default";
          }
          if (this._boundDoResize)
            removeEvent(document, moveEventName, this._boundDoResize);
          if (this._boundEndResize)
            removeEvent(document, endEventName, this._boundEndResize);

          this._boundDoResize = null;
          this._boundEndResize = null;
        }
      };
      FluentWindow.prototype.destroy = function () {
        try {
          if (this.id === "about-me") {
            console.log(
              "Stopping Lanyard updates due to About Me window closure."
            );
            stopLanyardUpdates();
          }
          var supportsTouch =
            "ontouchstart" in window ||
            (window.navigator && window.navigator.msMaxTouchPoints > 0);
          var down = supportsTouch ? "touchstart" : "mousedown";

          if (this._boundStartDrag)
            removeEvent(this.dragHandle, down, this._boundStartDrag);
          if (this._boundStartResize)
            removeEvent(this.resizeHandle, down, this._boundStartResize);
          if (this._boundBringToFront)
            removeEvent(this.element, down, this._boundBringToFront);
          if (this._boundDestroy)
            removeEvent(this.closeButton, "click", this._boundDestroy);

          var footer = this.element.querySelector(".links-section");
          if (footer && this._boundFooterClick) {
            removeEvent(footer, "click", this._boundFooterClick);
          }
          if (this.element && this.element.parentNode) {
            this.element.parentNode.removeChild(this.element);
          }
          delete windows[this.id];
          if (activeInteractionWindow === this) {
            activeInteractionWindow = null;
            document.body.style.cursor = "default";
          }
        } catch (e) {
          console.error("Error destroying window:", e);
        }
      };

      function addEvent(element, eventName, callback) {
        if (!element) return;
        if (element.addEventListener) {
          element.addEventListener(eventName, callback, false);
        } else if (element.attachEvent) {
          element.attachEvent("on" + eventName, callback);
        }
      }
      function removeEvent(element, eventName, callback) {
        if (!element) return;
        if (element.removeEventListener) {
          element.removeEventListener(eventName, callback, false);
        } else if (element.detachEvent) {
          element.detachEvent("on" + eventName, callback);
        }
      }
      function createWindow(id, title, titleIconUrl, contentHtml, options) {
        if (windows[id]) {
          windows[id].bringToFront();
          return windows[id];
        }
        var newWindow = null;
        try {
          newWindow = new FluentWindow(
            id,
            title,
            titleIconUrl,
            contentHtml,
            options
          );
          windows[id] = newWindow;
        } catch (createErr) {
          console.error("Error creating window '" + id + "':", createErr);
          alert("Failed to create window: " + (createErr.message || createErr));
          return null;
        }
        return newWindow;
      }
      function makeRequest(url, callback) {
        try {
          var xhr = new XMLHttpRequest();
          xhr.open("GET", url, true);
          xhr.onreadystatechange = function () {
            if (xhr.readyState === 4) {
              if (xhr.status >= 200 && xhr.status < 300) {
                try {
                  var data = JSON.parse(xhr.responseText);
                  callback(null, data);
                } catch (parseError) {
                  console.error(
                    "Error parsing JSON:",
                    parseError,
                    xhr.responseText
                  );
                  callback(new Error("Invalid JSON received"), null);
                }
              } else {
                console.error("XHR failed:", xhr.status, xhr.statusText);
                callback(new Error("Request failed: " + xhr.status), null);
              }
            }
          };
          xhr.onerror = function () {
            console.error("XHR network error");
            callback(new Error("Network error"), null);
          };
          xhr.send();
        } catch (e) {
          console.error("Error creating/sending XHR:", e);
          callback(e, null);
        }
      }
      function formatDate(isoString) {
        if (!isoString) return "N/A";
        try {
          var d = new Date(isoString);
          var months = [
            "Jan",
            "Feb",
            "Mar",
            "Apr",
            "May",
            "Jun",
            "Jul",
            "Aug",
            "Sep",
            "Oct",
            "Nov",
            "Dec",
          ];
          return (
            months[d.getMonth()] + " " + d.getDate() + ", " + d.getFullYear()
          );
        } catch (e) {
          console.error("Error formatting date:", e);
          return "Invalid Date";
        }
      }

      function fetchProjects(username, callback) {
        var apiUrl =
          "https://api.github.com/users/" +
          username +
          "/repos?sort=updated&per_page=20";
        makeRequest(apiUrl, function (error, data) {
          if (error) {
            console.error("Error fetching projects:", error);
          }
          callback(error, data);
        });
      }
      function renderProjects(repos, containerElement) {
        if (!containerElement) return;
        containerElement.innerHTML = "";
        if (!repos || !Array.isArray(repos) || repos.length === 0) {
          containerElement.innerHTML =
            '<p class="error-message">No public projects found or failed to load.</p>';
          return;
        }
        var list = document.createElement("ul");
        for (var i = 0; i < repos.length; i++) {
          var repo = repos[i];
          var li = document.createElement("li");
          var topics = repo.topics;
          var tags = "";
          if (topics && Array.isArray(topics)) {
            for (var j = 0; j < topics.length; j++) {
              tags += "<span>" + topics[j] + "</span> ";
            }
          }
          var licenseName =
            repo.license && repo.license.name ? repo.license.name : null;
          var license = licenseName
            ? '<span class="project-license">' + licenseName + "</span>"
            : "";
          var lang = repo.language
            ? '<span class="project-lang ' +
              repo.language.toLowerCase().replace(/[^a-z0-9]/g, "") +
              '">' +
              repo.language +
              "</span>"
            : '<span class="project-lang na">N/A</span>';
          li.innerHTML =
            '<h3 class="project-title"><a href="' +
            (repo.html_url || "#") +
            '" target="_blank" rel="noopener noreferrer">' +
            (repo.name || "Unnamed Repo") +
            '</a> <span class="project-visibility">Public</span></h3>' +
            '<p class="project-desc">' +
            (repo.description || "No description.") +
            "</p>" +
            '<div class="project-tags">' +
            tags.trim() +
            "</div>" +
            '<div class="project-meta">' +
            lang +
            license +
            '<span class="project-date">Updated ' +
            formatDate(repo.updated_at) +
            "</span></div>";
          list.appendChild(li);
        }
        containerElement.appendChild(list);
      }
      function displayError(error, containerElement) {
        if (!containerElement) return;
        var errorMessage =
          error && error.message ? error.message : "Unknown error";
        containerElement.innerHTML =
          '<p class="error-message">Error loading projects: ' +
          errorMessage +
          "</p>";
      }

      function connectLanyardSocket(userId) {
        lanyardUpdateMethod = "websocket";
        lanyardWSRetryCount = 0;
        if (lanyardSocket && lanyardSocket.readyState === WebSocket.OPEN) {
          console.log("Lanyard WebSocket already open.");
          return;
        }
        if (lanyardReconnectTimeout) {
          clearTimeout(lanyardReconnectTimeout);
          lanyardReconnectTimeout = null;
        }
        if (lanyardHeartbeatInterval) {
          clearInterval(lanyardHeartbeatInterval);
          lanyardHeartbeatInterval = null;
        }
        console.log(
          "Connecting to Lanyard WebSocket (Attempt " +
            (lanyardWSRetryCount + 1) +
            ")"
        );
        updateDiscordStatusUI({
          contentHtml:
            '<p class="loading-message">Connecting via WebSocket...</p>',
          customStatus: null,
        });
        try {
          lanyardSocket = new WebSocket(LANYARD_WS_PROXY_URL);
        } catch (err) {
          console.error("Failed to create WebSocket:", err);
          updateDiscordStatusUI({
            contentHtml:
              '<p class="error-message">WebSocket creation failed.</p>',
            customStatus: null,
          });
          handleWebSocketFailure(userId, "Creation failed");
          return;
        }
        lanyardSocket.onopen = function () {
          console.log("Lanyard WebSocket connected successfully.");
          lanyardWSRetryCount = 0;
        };
        lanyardSocket.onmessage = function (event) {
          try {
            if (!event.data) return;
            var data = JSON.parse(event.data);
            switch (data.op) {
              case 1:
                console.log("Lanyard: Received Hello");
                var heartbeatIntervalMs = data.d.heartbeat_interval;
                lanyardSocket.send(
                  JSON.stringify({ op: 2, d: { subscribe_to_id: userId } })
                );
                console.log("Lanyard: Sent Initialize for user:", userId);
                if (lanyardHeartbeatInterval)
                  clearInterval(lanyardHeartbeatInterval);
                lanyardHeartbeatInterval = setInterval(function () {
                  try {
                    if (
                      lanyardSocket &&
                      lanyardSocket.readyState === WebSocket.OPEN
                    ) {
                      lanyardSocket.send(JSON.stringify({ op: 3 }));
                    } else {
                      if (lanyardHeartbeatInterval)
                        clearInterval(lanyardHeartbeatInterval);
                      lanyardHeartbeatInterval = null;
                    }
                  } catch (hbError) {
                    console.error("Error sending heartbeat:", hbError);
                    if (lanyardHeartbeatInterval)
                      clearInterval(lanyardHeartbeatInterval);
                    lanyardHeartbeatInterval = null;
                  }
                }, heartbeatIntervalMs);
                break;
              case 0:
                if (data.t === "INIT_STATE" || data.t === "PRESENCE_UPDATE") {
                  var parsedStatus = parseLanyardStatus(data.d);
                  updateDiscordStatusUI(parsedStatus);
                }
                break;
              default:
                console.log("Lanyard: Received unknown opcode:", data.op);
            }
          } catch (msgError) {
            console.error(
              "Error processing WebSocket message:",
              msgError,
              event.data
            );
          }
        };
        lanyardSocket.onerror = function (error) {
          console.error("Lanyard WebSocket Error Event:", error);
          handleWebSocketFailure(userId, "WebSocket onerror");
        };
        lanyardSocket.onclose = function (event) {
          console.log("Lanyard WebSocket closed.", event.code, event.reason);
          if (lanyardHeartbeatInterval) {
            clearInterval(lanyardHeartbeatInterval);
            lanyardHeartbeatInterval = null;
          }
          if (lanyardReconnectTimeout) {
            clearTimeout(lanyardReconnectTimeout);
            lanyardReconnectTimeout = null;
          }
          lanyardSocket = null;
          if (
            event.code !== 1000 &&
            event.code !== 1005 &&
            event.code !== 1001
          ) {
            handleWebSocketFailure(
              userId,
              "Unclean close (" + event.code + ")"
            );
          } else {
            if (windows["about-me"]) {
              updateDiscordStatusUI({
                contentHtml:
                  '<p class="error-message">Disconnected from presence.</p>',
                customStatus: null,
              });
            }
          }
        };
      }
      function handleWebSocketFailure(userId, reason) {
        lanyardWSRetryCount++;
        console.log(
          "WebSocket connection failed (" +
            reason +
            "). Retry count: " +
            lanyardWSRetryCount
        );
        if (lanyardSocket) {
          lanyardSocket = null;
        }
        if (lanyardHeartbeatInterval) {
          clearInterval(lanyardHeartbeatInterval);
          lanyardHeartbeatInterval = null;
        }
        if (lanyardWSRetryCount > LANYARD_MAX_WS_RETRIES) {
          console.error(
            "Lanyard: Max WebSocket retries reached. Switching to polling."
          );
          updateDiscordStatusUI({
            contentHtml:
              '<p class="error-message">WebSocket Error. Falling back to polling...</p>',
            customStatus: null,
          });
          if (lanyardReconnectTimeout) {
            clearTimeout(lanyardReconnectTimeout);
            lanyardReconnectTimeout = null;
          }
          if (windows["about-me"]) {
            startLanyardPolling(userId);
          }
        } else {
          scheduleLanyardReconnect(userId);
        }
      }
      function disconnectLanyardSocket() {
        lanyardWSRetryCount = LANYARD_MAX_WS_RETRIES + 1;
        if (lanyardReconnectTimeout) {
          clearTimeout(lanyardReconnectTimeout);
          lanyardReconnectTimeout = null;
        }
        if (lanyardHeartbeatInterval) {
          clearInterval(lanyardHeartbeatInterval);
          lanyardHeartbeatInterval = null;
        }
        if (lanyardSocket && lanyardSocket.readyState === WebSocket.OPEN) {
          console.log("Lanyard: Closing WebSocket connection intentionally.");
          try {
            lanyardSocket.close(1000, "Client closed window");
          } catch (e) {}
        }
        lanyardSocket = null;
      }
      function scheduleLanyardReconnect(userId) {
        if (lanyardReconnectTimeout) {
          clearTimeout(lanyardReconnectTimeout);
        }
        if (lanyardUpdateMethod !== "websocket") return;
        var retryMsg =
          "WebSocket connection lost. Retrying (" +
          lanyardWSRetryCount +
          "/" +
          LANYARD_MAX_WS_RETRIES +
          ")...";
        updateDiscordStatusUI({
          contentHtml: '<p class="error-message">' + retryMsg + "</p>",
          customStatus: null,
        });
        console.log(
          "Lanyard: Scheduling WebSocket reconnect in " +
            LANYARD_RECONNECT_DELAY / 1000 +
            " seconds..."
        );
        lanyardReconnectTimeout = setTimeout(function () {
          if (
            lanyardWSRetryCount <= LANYARD_MAX_WS_RETRIES &&
            lanyardUpdateMethod === "websocket" &&
            windows["about-me"]
          ) {
            connectLanyardSocket(userId);
          }
        }, LANYARD_RECONNECT_DELAY);
      }
      function pollLanyardStatus(userId) {
        var apiUrl = LANYARD_API_PROXY_BASE + userId;
        makeRequest(apiUrl, function (error, responseData) {
          if (!windows["about-me"] || lanyardUpdateMethod !== "polling") {
            stopLanyardPolling();
            return;
          }
          if (error || !responseData || !responseData.success) {
            lanyardPollFailureCount++;
            console.error(
              "Lanyard poll failed (Attempt " + lanyardPollFailureCount + "):",
              error || "Invalid response"
            );
            if (lanyardPollFailureCount >= LANYARD_MAX_POLL_FAILURES) {
              console.error(
                "Lanyard: Max polling failures reached. Stopping polling."
              );
              updateDiscordStatusUI({
                contentHtml:
                  '<p class="error-message">Polling Error: Failed to fetch status repeatedly.</p>',
                customStatus: null,
              });
              stopLanyardPolling();
            } else {
              var tempErrorHtml =
                '<p class="error-message">Error fetching status... (Attempt ' +
                lanyardPollFailureCount +
                "/" +
                LANYARD_MAX_POLL_FAILURES +
                ")</p>";
              updateDiscordStatusUI({
                contentHtml: tempErrorHtml,
                customStatus: null,
              });
            }
          } else if (responseData.data) {
            lanyardPollFailureCount = 0;
            var parsedStatus = parseLanyardStatus(responseData.data);
            updateDiscordStatusUI(parsedStatus);
          } else {
            lanyardPollFailureCount++;
            console.error(
              "Lanyard poll: Success false or no data.",
              responseData
            );
            if (lanyardPollFailureCount >= LANYARD_MAX_POLL_FAILURES) {
              stopLanyardPolling();
              updateDiscordStatusUI({
                contentHtml:
                  '<p class="error-message">Polling Error: Received invalid status data repeatedly.</p>',
                customStatus: null,
              });
            } else {
              updateDiscordStatusUI({
                contentHtml:
                  '<p class="error-message">Error fetching status... (Invalid data attempt ' +
                  lanyardPollFailureCount +
                  "/" +
                  LANYARD_MAX_POLL_FAILURES +
                  ")</p>",
                customStatus: null,
              });
            }
          }
        });
      }
      function startLanyardPolling(userId) {
        if (lanyardUpdateMethod === "polling") return;
        console.log("Starting Lanyard polling.");
        lanyardUpdateMethod = "polling";
        lanyardPollFailureCount = 0;
        disconnectLanyardSocket();
        updateDiscordStatusUI({
          contentHtml:
            '<p class="loading-message">Fetching status (polling)...</p>',
          customStatus: null,
        });
        pollLanyardStatus(userId);
        if (lanyardPollIntervalId) clearInterval(lanyardPollIntervalId);
        lanyardPollIntervalId = setInterval(function () {
          if (
            lanyardPollIntervalId &&
            windows["about-me"] &&
            lanyardUpdateMethod === "polling"
          ) {
            pollLanyardStatus(userId);
          } else {
            stopLanyardPolling();
          }
        }, LANYARD_POLL_INTERVAL_MS);
      }
      function stopLanyardPolling() {
        if (lanyardPollIntervalId) {
          clearInterval(lanyardPollIntervalId);
          lanyardPollIntervalId = null;
          console.log("Stopped Lanyard polling.");
        }
        if (lanyardUpdateMethod === "polling") {
          lanyardUpdateMethod = null;
        }
      }
      function stopLanyardUpdates() {
        if (lanyardUpdateMethod === "websocket") {
          disconnectLanyardSocket();
        } else if (lanyardUpdateMethod === "polling") {
          stopLanyardPolling();
        }
        lanyardUpdateMethod = null;
        if (document.getElementById("discord-status-area")) {
          updateDiscordStatusUI({
            contentHtml:
              '<p class="error-message">Presence updates stopped.</p>',
            customStatus: null,
          });
        }
      }
      function parseLanyardStatus(lanyardData) {
        var finalContentHtml = "";
        var customStatusText = null;
        var customStatusEmoji = null;
        if (!lanyardData || typeof lanyardData !== "object") {
          console.warn("Invalid Lanyard data received:", lanyardData);
          finalContentHtml =
            '<p class="error-message">Invalid presence data received.</p>';
          return { contentHtml: finalContentHtml, customStatus: null };
        }
        var presenceStatus = lanyardData.discord_status || "offline";
        var activities = lanyardData.activities || [];
        var statusText = "Offline";
        var statusClass = "status-offline";
        if (presenceStatus === "online") {
          statusText = "Online";
          statusClass = "status-online";
        } else if (presenceStatus === "idle") {
          statusText = "Idle";
          statusClass = "status-idle";
        } else if (presenceStatus === "dnd") {
          statusText = "Do Not Disturb";
          statusClass = "status-dnd";
        }
        var statusHtml =
          '<div class="status-container"><span class="' +
          statusClass +
          '">' +
          statusText +
          "</span></div>";
        finalContentHtml += statusHtml;
        var customActivity = null;
        for (var i = 0; i < activities.length; i++) {
          if (activities[i].type === 4) {
            customActivity = activities[i];
            break;
          }
        }
        if (customActivity) {
          customStatusText = customActivity.state || null;
          if (customActivity.emoji && customActivity.emoji.name) {
            customStatusEmoji = customActivity.emoji.name;
            if (customStatusText) {
              customStatusText = customStatusEmoji + " " + customStatusText;
            } else {
              customStatusText = customStatusEmoji;
            }
          }
        }
        var activitiesHtml = "";
        if (presenceStatus !== "offline") {
          if (lanyardData.listening_to_spotify && lanyardData.spotify) {
            var spotify = lanyardData.spotify;
            var spotifyItemHtml = '<div class="activity-item spotify">';
            if (spotify.album_art_url) {
              spotifyItemHtml +=
                '<img src="' +
                spotify.album_art_url +
                '" alt="' +
                (spotify.album || "Album Art") +
                '" class="activity-icon spotify-art">';
            } else {
              spotifyItemHtml += '<span class="activity-icon">🎵</span>';
            }
            spotifyItemHtml += '<span class="activity-text">';
            spotifyItemHtml +=
              "Listening to <strong>" +
              (spotify.song || "Unknown Song") +
              "</strong>";
            if (spotify.artist) spotifyItemHtml += " by " + spotify.artist;
            spotifyItemHtml += "</span></div>";
            activitiesHtml += spotifyItemHtml;
          }
          for (var i = 0; i < activities.length; i++) {
            var activity = activities[i];
            if (activity.type === 4) continue;
            if (activity.type === 2 && lanyardData.listening_to_spotify)
              continue;
            var activityItemHtml = "";
            var icon = "💡";
            var imageUrl = null;
            var imageAlt = "";
            var name = activity.name || "";
            var details = activity.details || "";
            var state = activity.state || "";
            var assets = activity.assets;
            var largeImage = assets && assets.large_image;
            var largeText = (assets && assets.large_text) || name || "";
            var appId = activity.application_id;
            if (largeImage) {
              if (largeImage.indexOf("spotify:") === 0) {
              } else if (largeImage.indexOf("mp:") === 0) {
                imageUrl =
                  "https://media.discordapp.net/" + largeImage.substring(3);
                imageAlt = largeText || name;
              } else if (appId) {
                imageUrl =
                  "https://cdn.discordapp.com/app-assets/" +
                  appId +
                  "/" +
                  largeImage +
                  ".png";
                imageAlt = largeText || name;
              }
            }
            var textContent = "";
            if (activity.type === 0) {
              icon = "🎮";
              textContent =
                "Playing <strong>" +
                name +
                "</strong>" +
                (details ? "<br>" + details : "") +
                (state ? "<br>" + state : "");
            } else if (activity.type === 1) {
              icon = "🎙️";
              textContent =
                "Streaming <strong>" +
                name +
                "</strong>" +
                (details ? "<br>" + details : "") +
                (state ? "<br>" + state : "");
            } else if (activity.type === 2) {
              icon = "🎵";
              textContent =
                "Listening to <strong>" +
                name +
                "</strong>" +
                (details ? "<br>" + details : "") +
                (state ? " by " + state : "");
            } else if (activity.type === 3) {
              icon = "📺";
              textContent =
                "Watching <strong>" +
                name +
                "</strong>" +
                (details ? "<br>" + details : "") +
                (state ? "<br>" + state : "");
            } else if (appId === "383226320970055681") {
              icon = "💻";
              textContent = "<strong>" + name + "</strong>";
              if (details) textContent += "<br>" + details;
              if (state) textContent += "<br>" + state;
              if (largeText && textContent.indexOf(largeText) === -1)
                textContent += "<br>" + largeText;
            } else if (name === "Waze") {
              icon = "🚗";
              textContent = "Using <strong>" + name + "</strong>";
            } else if (name) {
              textContent =
                icon +
                " <strong>" +
                name +
                "</strong>" +
                (details ? "<br>" + details : "") +
                (state ? "<br>" + state : "");
            }
            if (textContent) {
              activityItemHtml += '<div class="activity-item">';
              if (imageUrl) {
                activityItemHtml +=
                  '<img src="' +
                  imageUrl +
                  '" alt="' +
                  imageAlt +
                  '" class="activity-icon" onerror="this.style.display=\'none\'">';
              } else {
                activityItemHtml +=
                  '<span class="activity-icon" style="display: flex; align-items: center; justify-content: center; font-size: 1.5em;">' +
                  icon +
                  "</span>";
              }
              activityItemHtml +=
                '<span class="activity-text">' + textContent + "</span>";
              activityItemHtml += "</div>";
              activitiesHtml += activityItemHtml;
            }
          }
          if (activitiesHtml === "" && presenceStatus !== "offline") {
            activitiesHtml =
              '<div class="activity-item"><span class="activity-text">✨ Currently Idle</span></div>';
          }
        }
        finalContentHtml += activitiesHtml;
        return {
          contentHtml: finalContentHtml,
          customStatus: customStatusText,
        };
      }
      function updateDiscordStatusUI(statusResult) {
        var statusAreaElement = null;
        try {
          statusAreaElement = document.getElementById("discord-status-area");
          var bubbleElement = document.getElementById("custom-status-bubble");

          if (!statusAreaElement || !bubbleElement) {
            console.error(
              "updateDiscordStatusUI: Could not find statusArea or bubbleElement."
            );
            return;
          }

          if (statusResult && statusResult.contentHtml !== undefined) {
            statusAreaElement.innerHTML = statusResult.contentHtml;
          } else {
            console.error(
              "updateDiscordStatusUI called with invalid statusResult:",
              statusResult
            );
            statusAreaElement.innerHTML =
              '<p class="error-message">Error updating status display (Invalid data).</p>';
          }

          if (statusResult && statusResult.customStatus) {
            bubbleElement.textContent = statusResult.customStatus;
            bubbleElement.style.display = "";

            var reqAnimFrame =
              window.requestAnimationFrame ||
              function (callback) {
                window.setTimeout(callback, 16);
              };

            reqAnimFrame(function () {
              try {
                if (bubbleElement.classList) {
                  bubbleElement.classList.add("visible");
                } else {
                  bubbleElement.className += " visible";
                }
              } catch (rafError) {
                console.error(
                  "Error adding visible class to bubbleElement:",
                  rafError
                );
                bubbleElement.className += " visible";
              }
            });
          } else {
            bubbleElement.textContent = "";
            if (bubbleElement.classList) {
              bubbleElement.classList.remove("visible");
            } else {
              bubbleElement.className = bubbleElement.className.replace(
                /\bvisible\b/g,
                ""
              );
            }
            bubbleElement.style.display = "none";
          }
        } catch (e) {
          console.error("Error updating Discord status UI:", e);
          try {
            if (
              statusAreaElement &&
              statusAreaElement.innerHTML.indexOf("UI Update Error") === -1
            ) {
              statusAreaElement.innerHTML =
                '<p class="error-message">UI Update Error: ' +
                (e.message || "Unknown") +
                "</p>";
            } else if (!statusAreaElement) {
              console.error(
                "updateDiscordStatusUI: statusAreaElement is null."
              );
            } else {
              console.error(
                "updateDiscordStatusUI: statusAreaElement already has error message."
              );
            }
          } catch (innerErr) {
            console.error(
              "Error updating statusAreaElement with error message:",
              innerErr
            );
          }
        }
      }

      function createAboutMeWindow() {
        var windowId = "about-me";
        if (windows[windowId]) {
          windows[windowId].bringToFront();
          return;
        }
        var aboutWindow = createWindow(
          windowId,
          "About Me - Ben",
          PROFILE_PIC_URL,
          aboutMeContent,
          { footerHtml: aboutMeFooter }
        );
        if (!aboutWindow) return;
        if (window.WebSocket) {
          console.log("Using WebSocket.");
          connectLanyardSocket(DISCORD_USER_ID);
        } else {
          if (!window.WebSocket) {
            console.log("WebSocket API not supported, using polling.");
          } else {
            console.log("Older browser detected, using polling.");
          }
          startLanyardPolling(DISCORD_USER_ID);
        }
      }
      function createProjectsWindow() {
        var windowId = "projects";
        if (windows[windowId]) {
          windows[windowId].bringToFront();
          return;
        }
        var existingWindowCount = 0;
        for (var k in windows) {
          if (windows.hasOwnProperty(k)) existingWindowCount++;
        }
        var offsetX = 30 * existingWindowCount;
        var offsetY = 30 * existingWindowCount;
        var projectsWindow = createWindow(
          windowId,
          "My Projects",
          GITHUB_ICON_URL,
          projectsInitialContent,
          {
            footerHtml: projectsFooter,
            initialOffset: { x: offsetX, y: offsetY },
          }
        );
        if (!projectsWindow || !projectsWindow.element) return;

        var projectsListContainer =
          projectsWindow.element.querySelector(".projects-list");
        if (!projectsListContainer) {
          var children = projectsWindow.element.getElementsByTagName("div");
          for (var i = 0; i < children.length; i++) {
            if (
              (" " + children[i].className + " ").indexOf(" projects-list ") >
              -1
            ) {
              projectsListContainer = children[i];
              break;
            }
          }
        }

        if (projectsListContainer) {
          fetchProjects(GITHUB_USERNAME, function (error, repos) {
            if (error) {
              displayError(error, projectsListContainer);
            } else {
              renderProjects(repos, projectsListContainer);
            }
          });
        } else {
          console.error("Could not find .projects-list container.");
          if (projectsWindow.contentContainer) {
            projectsWindow.setContent(
              '<p class="error-message">Error: Could not initialize project list.</p>'
            );
          }
        }
      }
      function createPcRigsWindow() {
        var windowId = "pc-rigs";
        if (windows[windowId]) {
          windows[windowId].bringToFront();
          return;
        }
        var existingWindowCount = 0;
        for (var k in windows) {
          if (windows.hasOwnProperty(k)) existingWindowCount++;
        }
        var offsetX = 30 * existingWindowCount;
        var offsetY = 30 * existingWindowCount;
        createWindow(windowId, "PC Rigs", PC_RIGS_ICON_URL, pcRigsContent, {
          footerHtml: pcRigsFooter,
          initialOffset: { x: offsetX, y: offsetY },
        });
      }
      function createVehiclesWindow() {
        var windowId = "vehicles";
        if (windows[windowId]) {
          windows[windowId].bringToFront();
          return;
        }
        var existingWindowCount = 0;
        for (var k in windows) {
          if (windows.hasOwnProperty(k)) existingWindowCount++;
        }
        var offsetX = 30 * existingWindowCount;
        var offsetY = 30 * existingWindowCount;
        createWindow(
          windowId,
          "My Vehicles",
          VEHICLES_ICON_URL,
          vehiclesContent,
          {
            footerHtml: vehiclesFooter,
            initialOffset: { x: offsetX, y: offsetY },
          }
        );
      }

      function fetchSpotlightData() {
        makeRequest(SPOTLIGHT_API_URL, function (error, data) {
          if (error || !data || !Array.isArray(data) || data.length === 0) {
            console.log(
              "Failed to fetch or got invalid Spotlight data:",
              error || "Invalid data"
            );
            applyFallbackBackgroundStyles();
          } else {
            applySpotlightBackground(data);
          }
        });
      }
      function applySpotlightBackground(cachedItems) {
        var copyrightDiv = document.getElementById("copyright-info");
        try {
          var randomIndex = Math.floor(Math.random() * cachedItems.length);
          var selectedItem = cachedItems[randomIndex];
          var landscapePath =
            selectedItem && selectedItem.landscapePathCompressed;
          var portraitPath =
            selectedItem && selectedItem.portraitPathCompressed;
          var copyrightText = (selectedItem && selectedItem.copyright) || "";
          var title = (selectedItem && selectedItem.title) || "";

          if (!landscapePath || !portraitPath) {
            console.warn(
              "Selected cached item missing required image paths:",
              selectedItem
            );
            if (copyrightDiv)
              copyrightDiv.textContent = "Image information unavailable";
            applyFallbackBackgroundStyles();
            return;
          }

          var formatPath = function (path) {
            if (!path) return "";
            if (
              path.indexOf("http://") === 0 ||
              path.indexOf("https://") === 0 ||
              path.indexOf("//") === 0 ||
              path.indexOf("/") === 0
            ) {
              return path;
            }
            return SPOTLIGHT_IMAGE_BASE + path;
          };

          var fullLandscapeUrl = formatPath(landscapePath);
          var fullPortraitUrl = formatPath(portraitPath);
          var setBackgroundBasedOnOrientation = function () {
            var isPortrait =
              "matchMedia" in window &&
              window.matchMedia("(orientation: portrait)").matches;
            var imageUrl = isPortrait ? fullPortraitUrl : fullLandscapeUrl;
            document.body.style.backgroundImage = 'url("' + imageUrl + '")';
            document.body.style.backgroundRepeat = "no-repeat";
            document.body.style.backgroundPosition = "center center";
            document.body.style.backgroundAttachment = "fixed";
            document.body.style.backgroundSize = "cover";
            if (document.documentElement.style.setProperty) {
              document.documentElement.style.setProperty(
                "--bg-image-landscape",
                'url("' + fullLandscapeUrl + '")'
              );
              document.documentElement.style.setProperty(
                "--bg-image-portrait",
                'url("' + fullPortraitUrl + '")'
              );
            }
          };
          setBackgroundBasedOnOrientation();
          if ("matchMedia" in window) {
            var mediaQuery = window.matchMedia("(orientation: portrait)");
            if (mediaQuery.addEventListener) {
              mediaQuery.addEventListener(
                "change",
                setBackgroundBasedOnOrientation
              );
            } else if (mediaQuery.addListener) {
              mediaQuery.addListener(setBackgroundBasedOnOrientation);
            }
          }
          if (copyrightDiv) {
            var displayText = copyrightText.replace(/^\s+|\s+$/g, "");
            if (
              title &&
              displayText &&
              displayText.toLowerCase().indexOf(title.toLowerCase()) === -1
            ) {
              displayText = title + " | " + displayText;
            } else if (title && !displayText) {
              displayText = title;
            }
            copyrightDiv.textContent =
              displayText || "Image information unavailable";
            copyrightDiv.style.maxWidth = "40%";
            copyrightDiv.style.overflowWrap = "normal";
          }
        } catch (error) {
          console.error(
            "Error applying cached Spotlight data:",
            error.message,
            error.stack
          );
          if (copyrightDiv) {
            copyrightDiv.textContent = "Error displaying image info.";
          }
          applyFallbackBackgroundStyles();
        }
      }
      function applyFallbackBackgroundStyles() {
        console.log("Applying fallback background images.");
        var setFallbackBackground = function () {
          var isPortrait =
            "matchMedia" in window &&
            window.matchMedia("(orientation: portrait)").matches;
          var imageUrl = isPortrait
            ? FALLBACK_PORTRAIT_IMG
            : FALLBACK_LANDSCAPE_IMG;
          document.body.style.backgroundImage = 'url("' + imageUrl + '")';
          document.body.style.backgroundRepeat = "no-repeat";
          document.body.style.backgroundPosition = "center center";
          document.body.style.backgroundAttachment = "fixed";
          document.body.style.backgroundSize = "cover";
          if (document.documentElement.style.setProperty) {
            document.documentElement.style.setProperty(
              "--bg-image-landscape",
              'url("' + FALLBACK_LANDSCAPE_IMG + '")'
            );
            document.documentElement.style.setProperty(
              "--bg-image-portrait",
              'url("' + FALLBACK_PORTRAIT_IMG + '")'
            );
          }
        };
        setFallbackBackground();
        if ("matchMedia" in window) {
          var mediaQuery = window.matchMedia("(orientation: portrait)");
          if (mediaQuery.addEventListener) {
            mediaQuery.addEventListener("change", setFallbackBackground);
          } else if (mediaQuery.addListener) {
            mediaQuery.addListener(setFallbackBackground);
          }
        }
      }

      addEvent(document, "DOMContentLoaded", function () {
        var supportsTouch =
          "ontouchstart" in window ||
          (window.navigator && window.navigator.msMaxTouchPoints > 0);
        var move = supportsTouch ? "touchmove" : "mousemove";
        var up = supportsTouch ? "touchend" : "mouseup";

        addEvent(document, move, function (e) {
          if (activeInteractionWindow) {
            if (activeInteractionWindow.isDragging)
              activeInteractionWindow._doDrag(e);
            if (activeInteractionWindow.isResizing)
              activeInteractionWindow._doResize(e);
          }
        });
        addEvent(document, up, function (e) {
          if (activeInteractionWindow) {
            activeInteractionWindow._endDrag(e);
            activeInteractionWindow._endResize(e);
          }
          if (!activeInteractionWindow) {
            document.body.style.cursor = "default";
          }
        });

        fetchSpotlightData();
        createAboutMeWindow();
      });

      var reopenBtn = document.getElementById("reopenAboutMeBtn");
      if (reopenBtn) {
        addEvent(reopenBtn, "click", createAboutMeWindow);
      }
    </script>
  </body>
</html>
